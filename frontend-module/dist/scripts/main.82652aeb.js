"use strict";function LanguageController(a,b){var c=this;b.getCurrent().then(function(a){c.selected=a}),c.changeLanguage=function(b){a.use(b).then(function(){c.selected=b}),$.datepicker.setDefaults($.datepicker.regional[b])},b.getAll().then(function(a){c.languages=a})}function LoginController(a,b,c,d){var e=this;e.user={},e.errors={},e.companies=["VASS","VASSDigital","Serbatic"],e.company=e.companies[0],e.rememberMe=!0,d.get({key:"KEY"});var f=a.organization;null!==f&&void 0!==f&&(e.company=f),e.login=function(){void 0!==e.username&&void 0!==e.password&&void 0!==e.company?c.login({username:e.username,password:e.password,company:e.company}).then(function(){e.authenticationError=!1;var a=new Date,c=a.getTime();c+=8639136e5,a.setTime(c),document.cookie="organization="+e.company+";expires="+a.toGMTString()+";path=/",b.go("home")})["catch"](function(){e.authenticationError=!0,g("login.messages.error.authentication")}):(e.authenticationError=!0,g("login.messages.error.form"))},e.cancelarEvento=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};var g=function(a){e.Modal={msg:a,title:"login.messages.error.title",button:"login.messages.error.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")}}function AllocationController(a,b,c,d,e,f,g,h,i,j){var k=this;k.onNgInit=function(){a.activeOption="allocation",k.empleado={},k.leader={},k.asignacion=[],k.fecha2=null,d.query(function(a){k.empleados=a}),e.query(function(a){k.leaders=a})},k.change=function(){var a=k.empleado.id;Mentoring.isUndefinedOrNull(k.leader)||Mentoring.isUndefinedOrNull(k.leader.id)?Mentoring.isUndefinedOrNull(a)?k.asignaciones=[]:g.query({employeeId:a},function(a){k.asignaciones=a}):Mentoring.isUndefinedOrNull(a)?h.query({leaderId:k.leader.id},function(a){k.asignaciones=a}):j.query({leaderId:k.leader.id,employeeId:a},function(a){k.asignaciones=a})},k.changeMando=function(){Mentoring.isUndefinedOrNull(k.empleado)||Mentoring.isUndefinedOrNull(k.empleado.id)?Mentoring.isUndefinedOrNull(k.leader)||Mentoring.isUndefinedOrNull(k.leader.id)?k.asignaciones=[]:h.query({leaderId:k.leader.id},function(a){k.asignaciones=a}):Mentoring.isUndefinedOrNull(k.leader)||Mentoring.isUndefinedOrNull(k.leader.id)?g.query({employeeId:k.empleado.id},function(a){k.asignaciones=a}):j.query({leaderId:k.leader.id,employeeId:k.empleado.id},function(a){k.asignaciones=a})},k.showNewAllocation=function(){k.newAllocation={},$("form").removeClass("ng-sent"),k.empleado&&(k.newAllocation.employeeId=k.empleado.id),$("#myModalNew").modal("show");var a=new Date;k.fecha=b("date")(a,c.instant("dateFormat")),k.today=new Date},k.saveAllocation=function(){return Mentoring.isUndefinedOrNull(k.newAllocation.employeeId)||Mentoring.isUndefinedOrNull(k.newAllocation.leaderId)||Mentoring.isUndefinedOrNull(k.newAllocation.dateFrom)?void l({msg:"allocation.modal.new.invalid",title:"allocation.modal.new.warning"}):void i.guardar(k.newAllocation,function(){$("#myModalNew").modal("hide"),l({msg:"allocation.modal.new.modify",title:"allocation.modal.new.title"}),k.change()},function(a){l({msg:a.data.msg})})},k.modificar=function(){var a=k.allocationToMod,c=b("date")(a.dateFrom,"dd/MM/yyyy"),d=a.dateUntil?b("date")(a.dateUntil,"dd/MM/yyyy"):null,e={id:a.id,employeeId:a.employeeId,leaderId:a.leaderId,dateFrom:c,dateUntil:d};i.update(e,function(){$("#myModalModify").modal("hide"),l({msg:"allocation.modal.success.modify",title:"allocation.modal.success.title"}),k.change()},function(a){var b="allocation.modal.error.modify";a.data&&a.data.msg&&(b=a.data.msg),l({msg:b})})},k.obtenerId=function(a){k.showInputDate=!1,Mentoring.isUndefinedOrNull(a.dateUntil)&&(k.showInputDate=!0),k.allocationToMod=angular.copy(a),$("#myModalModify").modal("show")},k.cancelar=function(){k.fecha=null};var l=function(a){k.Modal={msg:a.msg||"allocation.modal.error.default",title:a.title||"allocation.modal.error.title",button:"allocation.modal.ok",action:a.action||function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")}}function AuditsController(a,b,c){var d=this;a.activeOption="configuration",d.onChangeDate=function(){var a="yyyy-MM-dd",e=b("date")(d.fromDate,a),f=b("date")(d.toDate,a);c.findByDates(e,f).then(function(a){d.audits=a})},d.today=function(){var a=new Date;d.toDate=new Date(a.getFullYear(),a.getMonth(),a.getDate()+1)},d.previousMonth=function(){var a=new Date;a=0===a.getMonth()?new Date(a.getFullYear()-1,0,a.getDate()):new Date(a.getFullYear(),a.getMonth()-1,a.getDate()),d.fromDate=a},d.today(),d.previousMonth(),d.onChangeDate()}function ConfigurationController(a,b){var c=this;a.activeOption="configuration",b.get().then(function(a){c.configuration=a})}function HealthController(a,b){var c=this;a.activeOption="configuration",c.updatingHealth=!0,c.separator=".",c.refresh=function(){c.updatingHealth=!0,b.checkHealth().then(function(a){c.healthData=c.transformHealthData(a),c.updatingHealth=!1},function(a){c.healthData=c.transformHealthData(a.data),c.updatingHealth=!1})},c.refresh(),c.getLabelClass=function(a){return"UP"===a?"label-success":"label-danger"},c.transformHealthData=function(a){var b=[];return c.flattenHealthData(b,null,a),b},c.flattenHealthData=function(a,b,d){return angular.forEach(d,function(d,e){c.isHealthObject(d)&&(c.hasSubSystem(d)?(c.addHealthObject(a,!1,d,c.getModuleName(b,e)),c.flattenHealthData(a,c.getModuleName(b,e),d)):c.addHealthObject(a,!0,d,c.getModuleName(b,e)))}),a},c.getModuleName=function(a,b){var d;return d=a&&b?a+c.separator+b:a?a:b?b:""},c.showHealth=function(a){c.currentHealth=a,$("#showHealthModal").modal("show")},c.addHealthObject=function(a,b,d,e){var f={name:e},g={},h=!1;return angular.forEach(d,function(a,b){"status"===b||"error"===b?f[b]=a:c.isHealthObject(a)||(g[b]=a,h=!0)}),h&&angular.extend(f,{details:g}),(b||h||f.error)&&a.push(f),f},c.hasSubSystem=function(a){var b=!1;return angular.forEach(a,function(a){a&&a.status&&(b=!0)}),b},c.isHealthObject=function(a){var b=!1;return angular.forEach(a,function(a,c){"status"===c&&(b=!0)}),b},c.baseName=function(a){if(a){var b=a.split(".");return b[0]}},c.subSystemName=function(a){if(a){var b=a.split(".");b.splice(0,1);var c=b.join(".");return c?" - "+c:""}}}function MetricsController(a,b,c){var d=this;a.activeOption="configuration",d.metrics={},d.updatingMetrics=!0,d.refresh=function(){d.updatingMetrics=!0,c.getMetrics().then(function(a){d.metrics=a,d.updatingMetrics=!1},function(a){d.metrics=a.data,d.updatingMetrics=!1})},b.$watch("metrics",function(a){d.servicesStats={},d.cachesStats={},angular.forEach(a.timers,function(a,b){if((-1!==b.indexOf("web.rest")||-1!==b.indexOf("service"))&&(d.servicesStats[b]=a),-1!==b.indexOf("net.sf.ehcache.Cache")){var c=b.lastIndexOf("."),e=b.substr(0,c);c=e.lastIndexOf("."),d.cachesStats[e]={name:e.substr(c+1),value:a}}})}),d.refresh(),d.refreshThreadDumpData=function(){c.threadDump().then(function(a){d.threadDump=a,d.threadDumpRunnable=0,d.threadDumpWaiting=0,d.threadDumpTimedWaiting=0,d.threadDumpBlocked=0,angular.forEach(a,function(a){"RUNNABLE"===a.threadState?d.threadDumpRunnable+=1:"WAITING"===a.threadState?d.threadDumpWaiting+=1:"TIMED_WAITING"===a.threadState?d.threadDumpTimedWaiting+=1:"BLOCKED"===a.threadState&&(d.threadDumpBlocked+=1)}),d.threadDumpAll=d.threadDumpRunnable+d.threadDumpWaiting+d.threadDumpTimedWaiting+d.threadDumpBlocked})},d.getLabelClass=function(a){return"RUNNABLE"===a?"label-success":"WAITING"===a?"label-info":"TIMED_WAITING"===a?"label-warning":"BLOCKED"===a?"label-danger":void 0}}function RolesController(a,b,c,d,e,f){var g=this;g.empleado=[],g.roles=[],g.rol="",g.correcto=!1,g.habilitado=!1,a.activeOption="configuration",g.loadAll=function(){b.query(function(a){g.empleados=a}),c.query(function(a){g.roles=a})},g.loadAll(),g.change=function(){$("#role").hasClass("ng-dirty")&&(g.habilitado=!1),d.query({userId:g.empleado.id},function(a){a.length>0?(g.rol=a[0].authorityName,g.habilitado="ROLE_ADMIN"===g.rol?!1:!0):(g.rol="ROLE_USER",g.habilitado=!0)})},g.guardar=function(a,b,c){if(c)if(g.correcto=!0,"ROLE_USER"===b)f.borrar({id:a});else{var d=e.agrupar(a,b);e.guardar(d)}}}function ConsultController(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){var A=this,B=d.get("consult");"login"!=b.current.name&&f.identity().then(function(e){if(a.activeOption="consult",A.account=e,A.user={firstName:e.firstName,lastName:e.lastName},A.esModificable=!0,!Mentoring.isUndefinedOrNull(e)&&!Mentoring.isUndefinedOrNull(e.roles)){if(A.leader={},A.evaluation={},A.empleado={},A.empleadoLeaderUser={},A.isLeader=e.isLeader,A.roleUSER=e.roles.indexOf("ROLE_USER")>-1,A.roleRRHH=e.roles.indexOf("ROLE_RRHH")>-1,A.roleGERENTE=e.roles.indexOf("ROLE_GERENTE")>-1,A.roleDIRECTOR=e.roles.indexOf("ROLE_DIRECTOR")>-1,A.roleDIRECTORG=e.roles.indexOf("ROLE_DIRECTORG")>-1,A.roleADMIN=e.roles.indexOf("ROLE_ADMIN")>-1,j.get(function(a){A.isEvaluationDate=a.value}),k.get(function(a){A.isFinalEvaluationDate=a.value}),l.get(function(a){A.evaluationYear=a.value}),A.isVisibleEvaluator=!(A.roleGERENTE||A.roleDIRECTOR),A.isLeader||A.roleRRHH||A.roleGERENTE||A.roleDIRECTOR||A.roleDIRECTORG||A.roleADMIN?(A.isVisibleLeader=A.isLeader&&!(A.roleRRHH||A.roleGERENTE||A.roleDIRECTOR||A.roleDIRECTORG||A.roleADMIN)?!1:!0,A.isVisible=!0):(A.isVisible=!1,A.isVisibleLeader=!1),A.roleUSER&&!(A.roleRRHH||A.roleGERENTE||A.roleDIRECTOR||A.roleDIRECTORG||A.roleADMIN)&&(0===A.isLeader?A.evaluations=i.query({employeeId:e.employeeId}):A.empleadosLeaderUser=n.query({leaderId:e.employeeId},function(a){if(B&&B.params.empleado){var b=a.filter(function(a){return a.employeeId===B.params.empleado?a:void 0});return b.length>0&&(A.empleadoLeaderUser.info=b[0]),void A.changeLeaderUser()}A.evaluations=i.query({employeeId:e.employeeId})}),A.esModificable=!1),A.roleADMIN||A.roleDIRECTORG){var g=[];g.push(q.query({},function(a){if(A.empleados=a,B&&B.params.empleado){var b=a.filter(function(a){return a.id===B.params.empleado?a:void 0});b.length>0&&(A.empleado.info=b[0])}}).$promise),g.push(r.query({},function(a){if(A.leaders=a,B&&B.params.leader){var b=a.filter(function(a){return a.id===B.params.leader.id?a:void 0});b.length>0&&(A.leader.info=b[0])}}).$promise),c.all(g).then(function(){A.empleado.info&&A.change(A.empleado.info.id)})}A.roleDIRECTOR&&(A.empleados=s.query({directionId:e.employeeId}),A.leaders=t.query({directionId:e.employeeId}),A.esModificable=!1),A.roleGERENTE&&(A.empleados=u.query({managerId:e.employeeId},function(a){if(B&&B.params.empleado){var b=a.filter(function(a){return a.id===B.params.empleado?a:void 0});b.length>0&&(A.empleado.info=b[0])}}),A.leaders=v.query({managerId:e.employeeId}),B&&void 0!==B.params&&A.change(B.params.empleado),A.esModificable=!1),A.roleRRHH&&(w.query(function(a){a.splice(0,0,{id:A.account.employeeId,employeeId:A.account.employeeId,firstSurname:A.account.lastName,name:A.account.firstName}),A.empleados=a}),x.query(function(a){A.leaders=a})),d.forget("consult")}"login"!==b.current.name&&(A.isAuthenticated=f.isAuthenticated())}),A.showEvaluatorInput=function(a){var b=!0;return(A.isLeader||A.roleRRHH||A.roleGERENTE||A.roleDIRECTOR||A.roleDIRECTORG||A.roleADMIN)&&(b=!0),a.employeeId==A.account.employeeId&&(b=!1),b},A.isEvaluador=function(a){return a.leaderId==A.account.employeeId},A.modificable=function(a){return z.modificable(A.account,a,A.evaluationYear,A.isEvaluationDate,A.isFinalEvaluationDate,A.roleRRHH,A.roleDIRECTORG,A.roleADMIN)},A.mostrarEvaluacion=function(a){y.setId(a.id),y.setModification(A.modificable(a)),y.setEvaluado(a),e.empleado=a.employeeId,e.leader=A.leader.info,e.evaluation=a,e.showInput=A.showEvaluatorInput(a),b.go("consultEvaluation")},A.changeLeaderUser=function(){Mentoring.isUndefinedOrNull(A.empleadoLeaderUser.info)?i.query({employeeId:A.account.employeeId},function(a){A.evaluations=a}):o.query({employeeId:A.empleadoLeaderUser.info.employeeId},function(a){A.evaluations=a})},A.change=function(a){A.evaluations=Mentoring.isUndefinedOrNull(a)?Mentoring.isUndefinedOrNull(A.leader.info)||Mentoring.isUndefinedOrNull(A.leader.info.id)?[]:m.query({leaderId:A.leader.info.id}):Mentoring.isUndefinedOrNull(A.leader.info)||Mentoring.isUndefinedOrNull(A.leader.info.id)?o.query({employeeId:a}):p.query({employeeId:a,leaderId:A.leader.info.id})},A.changeMando=function(a){A.dato2=a,A.evaluations=Mentoring.isUndefinedOrNull(a)?Mentoring.isUndefinedOrNull(A.empleado.info)||Mentoring.isUndefinedOrNull(A.empleado.info.id)?[]:o.query({employeeId:A.empleado.info.id}):Mentoring.isUndefinedOrNull(A.empleado.info)||Mentoring.isUndefinedOrNull(A.empleado.info.id)?m.query({leaderId:a}):p.query({employeeId:A.empleado.info.id,leaderId:a})}}function ConsultEvaluationController(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){g.memo("consult");var x=this;a.chart;var y=g.get("consult");null===y.state&&d.go("consult"),x.evaluation=y.params.evaluation,x.showInput=y.params.showInput,"login"!=d.current.name&&h.identity().then(function(a){if(x.account=a,x.showPrint=!1,!Mentoring.isUndefinedOrNull(a)&&!Mentoring.isUndefinedOrNull(a.roles)&&!Mentoring.isUndefinedOrNull(a.isLeader)){x.isLeader=a.isLeader,x.employeeId=a.employeeId,x.user={firstName:a.firstName,lastName:a.lastName},x.finalEvaluation=!1,z(),x.questions=[],x.states=[],x.empleado=[],x.competence=[],x.pillar=[],x.correcto=!1,x.evaluable=[],x.consult=!1,x.esModificable=!1,x.evaluable.info=[],x.destacados=[],x.mejorar=[],x.selected=[],x.respuesta=[],t.get(function(a){x.isEvaluationDate=a.value}),u.get(function(a){x.isFinalEvaluationDate=a.value});var b=o.getId(),f=o.getModification();if(x.userCanModifyType=!1,f&&a.roles.length>1){var g=a.roles;(g.indexOf("ROLE_ADMIN")>-1||g.indexOf("ROLE_RRHH")>-1||g.indexOf("ROLE_DIRECTORG")>-1)&&(x.userCanModifyType=!0,x.evaluationTypes=[{id:"auto",value:i.instant("consult.evaluation.auto")},{id:"eval",value:i.instant("consult.evaluation.eval")},{id:"final",value:i.instant("consult.evaluation.final")}])}x.evaluadoo=o.getEvaluado(),x.esModificable=f;var w;Mentoring.isUndefinedOrNull(x.evaluadoo)||(x.date=x.evaluadoo.creationDate,w=new Date(x.evaluadoo.creationDate).getFullYear()),x.getQuestionCode=function(a){x.codePregunta=a,x.definicionInfo=c.trustAsHtml(i.instant("evaluation.info."+a+".comportamientoInfo"))},x.evaluationId=[],p.get({id:b},function(c){if(!Mentoring.isUndefinedOrNull(c)){x.evaluationId=c,"final"===c.evaluationType&&(1==a.roles.length&&0==a.roles.indexOf("ROLE_USER")?a.employeeId==c.employeeId?x.showPrint=!0:v.get({employeeId:c.employeeId},function(b){void 0!=b.leaderId&&a.employeeId===b.leaderId&&(x.showPrint=!0)}):x.showPrint=!0);var d=x.evaluationId.evaluationType;"final"==d&&(x.finalEvaluation=!0),q.get({employeeId:x.evaluationId.employeeId},function(a){x.isLeader=parseInt(a[0]),Mentoring.isUndefinedOrNull(a[0])||(x.loadAll=function(){k.query(function(a){x.statess=a}),m.query(function(a){var b=[],c=0;if(0===x.isLeader){for(var d in a)"mando"!=a[d].competenceCode&&(b[c]=a[d],c++);x.competences=b}else x.competences=a}),n.query(function(a){x.pillars=a,0===x.isLeader?j.query({id:0},function(a){x.questionss=a}):j.query(function(a){x.questionss=a}),x.select=function(a,b){x.selected[b]=a},x.evaluationId.employeeId==x.evaluationId.leaderId?x.employeeId=x.evaluationId.employeeId:(x.evaluable.info.employeeId=x.evaluationId.employeeId,x.employeeId=x.evaluationId.leaderId),x.observaciones=x.evaluationId.observaciones,x.observacionesEvaluador=x.evaluationId.observacionesEvaluador,l.query({id:b},function(a){var c=[];for(var d in a)c[a[d].questionId]=a[d].statesId,x.selected[a[d].questionId]=a[d].statesId-1;x.respuesta=c,r.query({id:b},function(a){a.length>0&&a.length>0&&(x.destacados[0]=a[0].questionCode,x.listSelect.push(x.destacados[0]),x.destacados[1]=a[1].questionCode,x.listSelect.push(x.destacados[1]),x.destacados[2]=a[2].questionCode,x.listSelect.push(x.destacados[2]),x.mejorar[0]=a[3].questionCode,x.listSelect.push(x.mejorar[0]),x.mejorar[1]=a[4].questionCode,x.listSelect.push(x.mejorar[1]),x.mejorar[2]=a[5].questionCode,x.listSelect.push(x.mejorar[2]))})}),k.query(function(a){x.statess=a})})},x.loadAll())})}});x.submitForm=function(a,c,f,g){if(a){if(B(c)){x.correcto=!0;var h,i,j,k;Mentoring.isUndefinedOrNull(x.evaluable.info.employeeId)?(h=x.employeeId,i="auto",j=s.agrupar2(c,h,h,f,g,i,x.isFinalEvaluationDate,b)):(h=x.roleDIRECTOR||x.roleDIRECTORG||x.roleADMIN?x.evaluable.info.id:x.evaluable.info.employeeId,k=x.employeeId,i=x.isFinalEvaluationDate?"final":"eval",j=s.agrupar2(c,k,h,f,g,i,x.isFinalEvaluationDate,b)),x.userCanModifyType&&(j.evaluationType=x.evaluation.evaluationType);var l=1,m=4,n=s.agrupar(c,0,x.isFinalEvaluationDate),o=s.agrupar3(0,l,x.destacados,x.isFinalEvaluationDate),p=s.agrupar3(0,m,x.mejorar,x.isFinalEvaluationDate),q={evaluation:j,answers:n,outstanding:o,improvable:p};x.disableButton=!0,s.guardar2(q).then(function(a){var b="";b="save.evaluation.no.mark"==a.data.msg?"guardarCorrectoNoNota":"guardarCorrecto",x.Modal={msg:b,title:"consult.modal.ok.title",button:"consult.modal.ok",action:function(){$("#myModal").on("hidden.bs.modal",function(){$("#myModal").unbind("hidden.bs.modal"),e.empleado=x.employeeId,d.go("consult")}),$("#myModal").modal("hide")}},$("#myModal").modal("show")},function(a){var b=a.data.msg||"guardarFalla";x.Modal={msg:b,title:"consult.modal.error.title",button:"consult.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show"),x.disableButton=!1})}}else x.Modal={msg:"guardarNoSeObserva",title:"consult.modal.error.title",button:"consult.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show"),x.disableButton=!1},x.listSelect=[],x.add=function(){x.listSelect=[];for(var a=0;3>a;a++)Mentoring.isUndefinedOrNull(x.destacados[a])||x.listSelect.push(x.destacados[a]),Mentoring.isUndefinedOrNull(x.mejorar[a])||x.listSelect.push(x.mejorar[a])}}"login"!=d.current.name&&(x.isAuthenticated=h.isAuthenticated())});var z=function(){a.options={responsive:!0,scaleShowLine:!0,scaleOverride:!0,scaleSteps:5,scaleStepWidth:20,scaleStartValue:0,angleShowLineOut:!0,scaleBeginAtZero:!0,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:'"Arial"',pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legend:{display:!1}},x.evaluation.evaluationResult?A(x.evaluation.evaluationResult):w.get({employeeId:x.evaluadoo.employeeId,evaluationId:x.evaluadoo.id,year:year_evaluation},A)},A=function(b){var c=null,d=null;if(3==b.resultCompetences.length){c=["Talent","Attitude","Business","Talent/Attitude","Business","VASS"];var e=b.resultCompetences[0].scoreByPillar,f=b.resultCompetences[1].scoreByPillar,g=b.resultCompetences[2].scoreByPillar;d=[e[1],e[2],e[3],f[4],f[5],g[6]]}else if(2==b.resultCompetences.length){c=["Talent","Attitude","Business","VASS"];var e=b.resultCompetences[0].scoreByPillar,f=b.resultCompetences[1].scoreByPillar;d=[e[1],e[2],e[3],f[6]]}a.data={update:!1,labels:c,datasets:[{fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:d}]},x.noteEvaluation=b.note},B=function(a){var b,c="";for(var d in a)if(6===a[d]&&(b=C("preg"+d),0!==b)){if(!(c.indexOf(b)<0))return!1;c+=b}return!0},C=function(a){var b=x.questionss;if(!Mentoring.isUndefinedOrNull(b))for(var c=0,d=b.length;d>c;c++)if(b[c].questionsCode===a)return b[c].pillarId;return 0};x.printEvaluation=function(){var a=window.location,b=a.origin+a.pathname;b="api/evaluation/evaluation.pdf?evaluationId="+x.evaluationId.id,window.open(b)},$(window).on("scroll",function(){$(window).scrollTop()+window.innerHeight>=$("canvas").offset().top-$("canvas").innerHeight()&&(window.dispatchEvent(new Event("resize")),$(window).unbind("scroll"))})}function ConsultEvaluationAutoevaluationController(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B){var C=this;C.years=[];for(var D=(new Date).getFullYear(),E=2015;D>=E;E++)C.years.push(E);"login"!=c.current.name&&m.identity().then(function(b){if(a.$root.activeOption="consult",C.account=b,C.user={firstName:b.firstName,lastName:b.lastName},C.esModificable=!0,!Mentoring.isUndefinedOrNull(b)&&!Mentoring.isUndefinedOrNull(b.roles)){if(C.leader={},C.evaluation={},C.empleado={},C.empleadoLeaderUser={},C.isLeader=b.isLeader,C.roleUSER=b.roles.indexOf("ROLE_USER")>-1,C.roleRRHH=b.roles.indexOf("ROLE_RRHH")>-1,C.roleGERENTE=b.roles.indexOf("ROLE_GERENTE")>-1,C.roleDIRECTOR=b.roles.indexOf("ROLE_DIRECTOR")>-1,C.roleDIRECTORG=b.roles.indexOf("ROLE_DIRECTORG")>-1,C.roleADMIN=b.roles.indexOf("ROLE_ADMIN")>-1,C.roleRRHH||C.roleGERENTE||C.roleDIRECTOR||C.roleDIRECTORG||C.roleADMIN?C.isVisibleMando=!0:C.isLeader&&(C.isVisibleLeader=!0),C.roleUSER&&!(C.roleRRHH||C.roleGERENTE||C.roleDIRECTOR||C.roleDIRECTORG||C.roleADMIN)&&(C.empleadosLeaderUser=q.query(0===C.isLeader?{leaderId:b.employeeId}:{leaderId:b.employeeId}),C.esModificable=!1),C.roleADMIN||C.roleDIRECTORG){var e=[];e.push(s.query({},function(a){C.empleados=a}).$promise),e.push(t.query({},function(a){C.leaders=a}).$promise),d.all(e).then(function(){C.empleado.info&&C.change(C.empleado.info.id)})}C.roleDIRECTOR&&(C.empleados=u.query({directionId:b.employeeId}),C.leaders=v.query({directionId:b.employeeId}),C.esModificable=!1),C.roleGERENTE&&(C.empleados=w.query({managerId:b.employeeId}),C.leaders=y.query({managerId:b.employeeId})),C.roleRRHH&&(z.query(function(a){C.empleados=a,o.query({employeeId:b.employeeId},function(a){angular.forEach(a,function(a){a.id==b.employeeId&&C.empleados.push(a)})})}),A.query(function(a){C.leaders=a}))}"login"!==c.current.name&&(C.isAuthenticated=m.isAuthenticated())}),C.isEvaluador=function(a){return a.leaderId==C.account.employeeId},C.modificable=function(a){return B.modificable(C.account,a,C.isEvaluationDate,C.isFinalEvaluationDate,C.roleRRHH,C.roleDIRECTORG,C.roleADMIN)},C.getEvaluationsEmployee=function(a){Mentoring.isUndefinedOrNull(a)||(C.autoEvaluation=null,C.finalEvaluation=null,Mentoring.isUndefinedOrNull(C.year)&&(C.year=C.years[C.years.length-1]),x.get({employeeId:a,year:C.year},function(a){if(null===a.finalEvaluation||null===a.autoEvaluation){var b=null==a.finalEvaluation?"consult.evalauto.modal.final.evaluation.error":"consult.evalauto.modal.auto.evaluation.error";return C.Modal={msg:b,title:"consult.evalauto.modal.error.title",button:"consult.evalauto.modal.ok",action:function(){$("#myModal").modal("hide")}},void $("#myModal").modal("show")}C.metadata={},C.autoEvaluation={respuesta:[],destacados:[],mejorar:[],listSelect:[]},C.finalEvaluation={respuesta:[],destacados:[],mejorar:[],listSelect:[]};var c=a.finalEvaluation,d=a.autoEvaluation;f("consult.evalauto.evaluation."+d.evaluationType).then(function(a){C.metadata.autoEvaluation={creationDate:d.creationDate,employeeName:d.employee.firstSurname+" "+d.employee.secondSurname+", "+d.employee.name,leaderName:d.leader.firstSurname+" "+d.leader.secondSurname+", "+d.leader.name,evaluationType:a}}),f("consult.evalauto.evaluation."+c.evaluationType).then(function(a){C.metadata.finalEvaluation={creationDate:c.creationDate,employeeName:c.employee.firstSurname+" "+c.employee.secondSurname+", "+c.employee.name,leaderName:c.leader.firstSurname+" "+c.leader.secondSurname+", "+c.leader.name,evaluationType:a}}),h.query({},function(a){C.competences=a}),i.query(function(a){C.pillars=a});var e=void 0;e=0===C.isLeader?j.query({leader:0},function(a){C.questionss=a}).$promise:j.query(function(a){C.questionss=a}).$promise,e.then(function(){F(a.autoEvaluation.id,C.autoEvaluation,a.weightQuestions),F(a.finalEvaluation.id,C.finalEvaluation,a.weightQuestions)})},function(a){var b=a.data.msg||"consult.evalauto.modal.error";C.Modal={msg:b,title:"consult.evalauto.modal.error.title",button:"consult.evalauto.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")}))},C.changeEvaluator=function(a){C.autoEvaluation=null,C.finalEvaluation=null,Mentoring.isUndefinedOrNull(C.empleadosCopy)&&(C.empleadosCopy=angular.copy(C.empleados)),Mentoring.isUndefinedOrNull(a)?C.empleados=C.empleadosCopy:r.query({leaderId:a},function(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(a[c].employeeId);C.empleados=C.empleadosCopy.filter(function(a){return b.indexOf(a.id)>=0})})},C.changeYear=function(){Mentoring.isUndefinedOrNull(C.empleado.info)||Mentoring.isUndefinedOrNull(C.leader.info)||C.getEvaluationsEmployee(C.empleado.info.id)};var F=function(a,b,c){var e=[];e.push(k.query({id:a},function(a){for(var c=[],d={1:!1,2:!1,3:!1},e=function(b){var e=a[b],f=C.questionss.filter(function(a){return a.id==e.questionId});d[f[0].competenceId]=!0;var g={"class":"",questionId:f[0].questionsCode,pillarId:f[0].pillarId,value:e.statesId,competenceId:f[0].competenceId};c[b]=g},f=0,g=a.length;g>f;f++)e(f,g);for(var h=[],i=0,g=C.competences.length;g>i;i++){var j=C.competences[i];d[j.competenceId]&&h.push(j)}C.competences=h,b.respuesta=c}).$promise),e.push(l.query({id:a},function(a){a.length>0&&(b.destacados=[a[0].questionCode,a[1].questionCode,a[2].questionCode],b.mejorar=[a[3].questionCode,a[4].questionCode,a[5].questionCode],b.listSelect=[b.destacados[0],b.destacados[1],b.destacados[2],b.mejorar[0],b.mejorar[1],b.mejorar[2]])}).$promise),d.all(e).then(function(){for(var a=function(a){var d=b.respuesta[a],e=c.filter(function(a){return a.question.questionsCode===d.questionId}),g=e[0];if(d.value<=3&&5===g.value&&b.mejorar.indexOf(d.questionId)>-1&&(d["class"]="critical"),""===d["class"])switch(g.value){case 3:d["class"]="medium";break;case 5:d["class"]="high"}var h="Estado"+d.value;d.label=f.instant(h)},d=0,e=b.respuesta.length;e>d;d++)a(d,e)})};C.getQuestionCode=function(a){C.codePregunta=a,C.definicionInfo=e.trustAsHtml(f.instant("evaluation.info."+a+".comportamientoInfo"))}}function EvaluationController(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){function A(){var a="eval";return F.isFinalEvaluationDate?a="final":F.isEvaluationDate&&(a="auto"),a}function B(a,b,c){i.get({employeeId:a,leaderId:b,evaluationType:c},G)}function C(a){F.loadAll=function(){0===a?f.query({id:0},function(a){F.questionss=a}):f.query(function(a){F.questionss=a})},r.query(function(b){var c=[],d=0;if(0===a){for(var e in b)"mando"!=b[e].competenceCode&&(c[d]=b[e],d++);F.competences=c}else F.competences=b}),J(),F.loadAll()}function D(a,b){o.query({id:a},K),k.query({id:a},function(a){for(var c=0,d=0,e=0,f=a.length;f>e;e++)3>e?(F.destacados[c]=a[e].questionCode,c++):(F.mejorar[d]=a[e].questionCode,d++),b&&F.listSelect.push(a[e].questionCode)})}var E,F=this;"login"!=c.current.name&&(F.questions=[],F.states=[],F.empleado={},F.competence=[],F.pillar=[],F.evaluable={},F.destacados=[],F.mejorar=[],F.selected=[],F.respuesta=[],d.identity().then(function(b){if(a.activeOption="evaluation",F.account=b,!Mentoring.isUndefinedOrNull(b)&&!Mentoring.isUndefinedOrNull(b.roles)&&!Mentoring.isUndefinedOrNull(b.isLeader)){F.isLeader=b.isLeader,F.employeeId=b.employeeId,F.evaluableByUser=1==b.isLeader||b.roles.indexOf("ROLE_RRHH")>-1||b.roles.indexOf("ROLE_DIRECTORG")>-1?!0:!1,F.user={firstName:b.firstName,lastName:b.lastName},F.roleDIRECTOR=b.roles.indexOf("ROLE_DIRECTOR")>-1,F.roleDIRECTORG=b.roles.indexOf("ROLE_DIRECTORG")>-1,F.roleGERENTE=b.roles.indexOf("ROLE_GERENTE")>-1,F.roleADMIN=b.roles.indexOf("ROLE_ADMIN")>-1,F.roleRRHH=b.roles.indexOf("ROLE_RRHH")>-1,F.isEvaluation=!1,F.isAutoEvaluation=F.roleDIRECTOR||F.roleGERENTE||F.roleDIRECTORG?!1:!0,F.listSelect=[],F.data={labels:["Gestión: Talent","Gestión: Attitude","Gestión: Business","Mando: Talent Attitude","Mando: Business","VASS"],datasets:[{label:"Evaluación",fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:[70,88,87,70,75,85]}]},F.options={responsive:!0,scaleShowLine:!0,angleShowLineOut:!0,scaleShowLabels:!1,scaleBeginAtZero:!0,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:'"Arial"',pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="tc-chart-js-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'},t.get(function(a){F.isEvaluationDate=a.value}),u.get(function(a){F.isFinalEvaluationDate=a.value,e()});var e=function(){var e="panel panel-info evaluacion_forms";a.roleRRHH||1==b.isLeader?(F.empleado=[],F.roleDIRECTORG||F.roleADMIN||F.roleDIRECTOR||p.query({leaderId:F.employeeId},function(a){!F.isFinalEvaluation&&F.isEvaluationDate&&a.splice(0,0,{id:F.account.employeeId,employeeId:F.account.employeeId,firstSurnameEmployee:F.account.lastName,nameEmployee:F.account.firstName}),F.evaluables=a,F.isEvaluationDate&&(F.classEval=e)}),(F.roleDIRECTORG||F.roleADMIN)&&m.query({leaderId:F.employeeId},function(a){F.evaluables=F.isFinalEvaluation?a.filter(function(a){return a.id!=F.account.employeeId}):a}),F.roleRRHH&&w.query(function(a){!F.isFinalEvaluation&&F.isEvaluationDate&&a.splice(0,0,{id:F.account.employeeId,employeeId:F.account.employeeId,firstSurname:F.account.lastName,name:F.account.firstName}),F.evaluables=a}),F.roleDIRECTOR&&y.query({directionId:b.employeeId},function(a){F.evaluables=F.isFinalEvaluation?a.filter(function(a){return a.id!=F.account.employeeId}):a})):F.classEval=F.isEvaluationDate?e:e,F.isFinalEvaluation=F.isFinalEvaluationDate,F.classEval=F.isFinalEvaluation?e+" final":e,F.msgModal="incorrecto",F.loadAll(),F.roleDIRECTORG||F.roleDIRECTOR||F.roleADMIN||F.roleRRHH||F.isFinalEvaluation||!F.isEvaluationDate||(B(F.employeeId,F.employeeId,"auto"),h.query({employeeId:F.employeeId},function(a){if(a.length>0){E=a[0].id,F.observaciones=a[0].observations;var b=a[0].id;void 0!=b&&(o.query({id:b},K),k.query({id:b},function(a){a.length>0&&(F.destacados[0]=a[0].questionCode,F.destacados[1]=a[1].questionCode,F.destacados[2]=a[2].questionCode,F.mejorar[0]=a[3].questionCode,F.mejorar[1]=a[4].questionCode,F.mejorar[2]=a[5].questionCode)}))}})),"login"!=c.current.name&&(F.isAuthenticated=d.isAuthenticated())}}})),F.showEvaluatorInput=function(){var a=!0;return(F.isLeader||F.roleRRHH||F.roleGERENTE||F.roleDIRECTOR||F.roleDIRECTORG||F.roleADMIN)&&(a=!0),(null==F.evaluable.info||F.evaluable.info.id==F.account.employeeId)&&(a=!1),a},F.showEvaluationForm=function(){return F.roleDIRECTORG||F.roleADMIN||F.roleRRHH||F.isLeader||F.isEvaluationDate},F.getQuestionCode=function(a){F.codePregunta=a,F.definicionInfo=b.trustAsHtml(e.instant("evaluation.info."+a+".comportamientoInfo"))},F.loadAll=function(){Mentoring.isUndefinedOrNull(F.evaluable.info)&&(0===F.isLeader?f.query({id:0},function(a){F.questionss=a}):f.query(function(a){F.questionss=a})),r.query(function(a){var b=[],c=0;if(0===F.isLeader){for(var d in a)"mando"!=a[d].competenceCode&&(b[c]=a[d],c++);F.competences=b}else F.competences=a}),J()},F.select=function(a,b){F.selected[b]=a},F.change=function(){E=null,F.observaciones="",F.selected=[],F.respuesta=[],F.destacados=[],F.mejorar=[],Mentoring.isUndefinedOrNull(F.evaluable.info)||v.get({employeeId:F.evaluable.info.employeeId||F.evaluable.info.id},function(a){if(C(parseInt(a[0])),F.isFinalEvaluationDate||F.isEvaluationDate){var b=F.evaluable.info.employeeId||F.evaluable.info.id;B(b,F.employeeId,A())}})},F.changeoLD=function(){E=void 0,F.observaciones="",F.selected=[],F.respuesta=[],F.observaciones="",F.destacados=[],F.mejorar=[],F.roleDIRECTOR||F.roleDIRECTORG||F.roleADMIN||F.roleRRHH?Mentoring.insUndefinedOrNull(F.evaluable.info)?(F.isAutoEvaluation=F.isEvaluation?!0:!1,q.query({employeeId:F.employeeId},H)):(F.isEvaluation=!0,v.get({employeeId:F.evaluable.info.id},I),n.query({employeeId:F.evaluable.info.id,leaderId:F.employeeId
},H)):Mentoring.insUndefinedOrNull(F.evaluable.info)?(F.isAutoEvaluation=F.isEvaluation?!0:!1,q.query({employeeId:F.employeeId},H)):(F.isEvaluation=!0,v.get({employeeId:F.evaluable.info.employeeId},I),g.get({employeeId:F.evaluable.info.employeeId,leaderId:F.employeeId},G))};var G=function(a){if(!Mentoring.isUndefinedOrNull(a)){E=a.id;var b=a.id;F.observaciones=a.observations,Mentoring.isUndefinedOrNull(b)||D(b,!0)}},H=function(a){if(a.length>0){E=a[0].id;var b=a[0].id;F.observaciones=a[0].observations,Mentoring.isUndefinedOrNull(b)||D(b,!0)}},I=function(a){F.evaluadoLider=parseInt(a[0]),F.loadAll=function(){0===F.evaluadoLider?f.query({id:0},function(a){F.questionss=a}):f.query(function(a){F.questionss=a})},r.query(function(a){var b=[],c=0;if(0===F.evaluadoLider){for(var d in a)"mando"!=a[d].competenceCode&&(b[c]=a[d],c++);F.competences=b}else F.competences=a}),J(),F.loadAll()},J=function(){j.query(function(a){F.statess=a}),s.query(function(a){F.pillars=a})};F.submitForm=function(a,b,c){if(c=c||"",Mentoring.isUndefinedOrNull(F.evaluable.info)&&!F.account.isEvaluable)F.msgModal="errorNoEvaluable",$("#myModalGuardado12345").modal("show");else if(Mentoring.isUndefinedOrNull(F.evaluable.info)&&!F.isEvaluationDate)F.msgModal="errorNoAutoEvaluable",$("#myModalGuardado12345").modal("show");else if(a)if(F.validarNoSeObserva(b)){F.msgModal="correcto";var d=null,e=null,f=null;if((Mentoring.isUndefinedOrNull(F.evaluable.info)||F.evaluable.info.id===F.employeeId)&&F.isEvaluationDate)f=F.employeeId,e="auto",d=l.agrupar2(b,f,f,c,F.observacionesEvaluador,e,F.isFinalEvaluationDate,E);else{f=F.roleDIRECTOR||F.roleDIRECTORG||F.roleADMIN||F.roleRRHH?F.evaluable.info.id:F.evaluable.info.employeeId;var g=F.employeeId;e=F.isFinalEvaluationDate?"final":"eval",d=l.agrupar2(b,g,f,c,F.observacionesEvaluador,e,F.isFinalEvaluationDate,E)}var h=1,i=4,j=l.agrupar(b,0,F.isFinalEvaluationDate),k=l.agrupar3(0,h,F.destacados,F.isFinalEvaluationDate),m=l.agrupar3(0,i,F.mejorar,F.isFinalEvaluationDate),n={evaluation:d,answers:j,outstanding:k,improvable:m};F.disableButton=!0,l.guardar2(n).then(function(a){F.msgModal="save.evaluation.no.mark"==a.data.msg?"correctoNoNota":"correcto",$("#myModalGuardado12345").modal({keyboard:!1,backdrop:"static",show:!0})},function(a){F.msgModal="guardarFalla",$("#myModalGuardado12345").modal("show"),z.print(a.stack),F.disableButton=!1})}else F.msgModal="noSeObserva",$("#myModalGuardado12345").modal("show"),F.disableButton=!1},F.closeDialog=function(){$("#myModalGuardado12345").on("hidden.bs.modal",function(){c.go("home")}),$("#myModalGuardado12345").modal("hide")},F.validarNoSeObserva=function(a){var b,c="";for(var d in a)if(6===a[d]&&(b=F.getPillar("preg"+d),0!==b)){if(!(c.indexOf(b)<0))return!1;c+=b}return!0},F.getPillar=function(a){var b=F.questionss;if(!Mentoring.isUndefinedOrNull(b))for(var c=0,d=b.length;d>c;c++)if(b[c].questionsCode===a)return b[c].pillarId;return 0},F.add=function(){F.listSelect=[];for(var a=0;3>a;a++)Mentoring.isUndefinedOrNull(F.destacados[a])||F.listSelect.push(F.destacados[a]),Mentoring.isUndefinedOrNull(F.mejorar[a])||F.listSelect.push(F.mejorar[a])};var K=function(a){F.respuesta=[];for(var b in a){var c=a[b];F.respuesta[c.questionId]=c.statesId,F.selected[c.questionId]=c.statesId-1}}}function EvaluationleaderController(a,b,c,d,e,f,g,h){var i=this;i.states=[],i.empleado=[],i.question=[],i.competence=[],i.pillar=[],i.loadAll=function(){a.query(function(a){i.questionss=a}),b.query(function(a){i.statess=a}),g.query(function(a){i.competences=a}),h.query(function(a){i.pillars=a})},i.loadAll(),i.empleado=[],i.empleados=[],i.mando=[],i.mandos=[],e.query(function(a){var b=[],c=[],d=0,e=0;for(var f in a)a[f].leaderId==dato&&(b[d]=a[f],d++),1==a[f].leader&&(c[e]=a[f],e++);i.empleados=b,i.mandos=c}),i.changeMando=function(a){i.loadAll(),i.empleado=[],i.empleados=[];var b=[];e.query(function(c){var d=0;for(var e in c)c[e].leaderId==a.employeeId&&(b[d]=c[e],d++);i.empleados=b})},i.change=function(a){i.loadAll(),i.submitForm=function(b,d){var e=a.employeeId,f=i.mando.employeeId,g=c.agrupar(b,e);c.guardar(g);var h=c.agrupar2(b,e,d,f);c.guardar2(h)},i.respuesta=[],i.observaciones="Escriba aquí las observaciones",f.query({employeeId:a.employeeId},function(a){var b=null,c=null;for(var e in a)a[e].leaderId==i.mando.employeeId.employeeId&&(c=a[e].answerId,b=a[e].observaciones);i.observaciones=b,void 0!==c&&d.query({id:c},function(a){var b=[];for(var c in a)b[a[c].questionId]=a[c].statesId;i.respuesta=b}),i.observaciones=a[0].observaciones})}}function LeadersEvaluationsController(a,b,c,d,e,f){var g=this;a.activeOption="consult",g.onNgInit=function(){"login"!=b.current.name&&d.identity().then(function(){d.isAuthenticated||b.go("login"),e.query({},function(a){g.leaders=a}),g.years=[];for(var a=new Date,c=2015,f=a.getFullYear();f>=c;)g.years.push(c),c++},function(){b.go("login")})},g.changeYear=function(){g.changeEvaluator()},g.changeEvaluator=function(){if(Mentoring.isUndefinedOrNull(g.year)){var a=new Date;g.year=a.getFullYear()}Mentoring.isUndefinedOrNull(g.leader)?g.showTable=!1:f.getLeadersEvaluations({leaderId:g.leader.id,year:g.year},function(a){a.length>0?(g.showTable=!0,a.map(function(a){var b=a.employee;a.employee.name=b.firstSurname+" "+b.secondSurname+", "+b.name;var d="leadersEvaluation.tabla.";a.selfEvaluation?(d+="si",a.selfEvaluationClass="circle-green"):(d+="no",a.selfEvaluationClass="circle-red"),a.selfEvaluation=c.instant(d);var e="leadersEvaluation.tabla.";a.finalEvaluation?(e+="si",a.finalEvaluationClass="circle-green"):(e+="no",a.finalEvaluationClass="circle-red"),a.finalEvaluation=c.instant(e)}),g.leadersEvaluations=a):g.showTable=!1},function(){g.Modal={msg:"leadersEvaluation.modal.error",title:"leadersEvaluation.modal.error.title",button:"leadersEvaluation.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")})},g.onNgInit()}function EmployeesEvaluationsController(a,b,c,d,e,f,g){var h=this;a.activeOption="consult",h.onNgInit=function(){"login"!=b.current.name&&d.identity().then(function(){d.isAuthenticated||b.go("login"),e.query({},function(a){h.directions=a},function(){j(function(){b.go("home")})});var a=2015,c=new Date;for(h.years=[];a<=c.getFullYear();)h.years.push(a),a++},function(){b.go("login")})},h.changeDirection=function(){h.showTable=!1,Mentoring.isUndefinedOrNull(h.direction)||f.getDirectionAreas({directionId:h.direction},function(a){h.areas=a},function(){j(function(){$("#myModal").modal("hide")})})},h.changeYear=function(){h.showTable=!1,Mentoring.isUndefinedOrNull(h.year)||Mentoring.isUndefinedOrNull(h.area)||i()},h.changeArea=function(){if(h.showTable=!1,!Mentoring.isUndefinedOrNull(h.area)){if(Mentoring.isUndefinedOrNull(h.year)){var a=new Date;h.year=a.getFullYear()}i()}};var i=function(){g.get({areaId:h.area,year:h.year},function(a){h.showTable=!0,a.map(k),h.evaluations=a},function(){j(function(){$("#myModal").modal("hide")})})},j=function(a){h.Modal={msg:"employeesEvaluation.modal.error",title:"employeesEvaluation.modal.error.title",button:"employeesEvaluation.modal.ok",action:a},$("#myModal").modal("show")},k=function(a){var b=a.employee;a.employee.name=b.firstSurname+" "+b.secondSurname+", "+b.name;var d="employeesEvaluation.tabla.";a.selfEvaluation?(d+="si",a.selfEvaluationClass="circle-green"):(d+="no",a.selfEvaluationClass="circle-red"),a.selfEvaluation=c.instant(d);var e="employeesEvaluation.tabla.";a.finalEvaluation?(e+="si",a.finalEvaluationClass="circle-green"):(e+="no",a.finalEvaluationClass="circle-red"),a.finalEvaluation=c.instant(e)};h.onNgInit()}function AllEvaluationsController(a,b,c,d,e){var f=this;a.activeOption="consult",f.onNgInit=function(){"login"!=b.current.name&&d.identity().then(function(){d.isAuthenticated||b.go("login");var a=2015,c=new Date;for(f.years=[];a<=c.getFullYear();)f.years.push(a),a++},function(){b.go("login")})},f.changeYear=function(){f.showTable=!1,f.excelDownloading=!1,f.excelButtonDisabled=!1,Mentoring.isUndefinedOrNull(f.year)||($("#pleaseWaitDialog").modal({backdrop:"static",show:!0}),e.getAllEvaluations({year:f.year},function(a){f.evaluations=a,a.map(function(a){var b=a.employee;if(a.employee.name=b.firstSurname+" "+b.secondSurname+", "+b.name,a.evaluator){var d=a.evaluator;a.evaluator.name=d.firstSurname+" "+d.secondSurname+", "+d.name}var e="evaluationAll.tabla.";a.selfEvaluation?(e+="si",a.selfEvaluationClass="circle-green"):(e+="no",a.selfEvaluationClass="circle-red"),a.selfEvaluation=c.instant(e);var f="evaluationAll.tabla.";a.finalEvaluation?(f+="si",a.finalEvaluationClass="circle-green"):(f+="no",a.finalEvaluationClass="circle-red"),a.finalEvaluation=c.instant(f)}),f.showTable=!0,$("#pleaseWaitDialog").modal("hide")},function(){$("#pleaseWaitDialog").modal("hide"),f.Modal={msg:"evaluationAll.modal.msg",title:"evaluationAll.modal.title",button:"evaluationAll.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")}))},f.getExcel=function(){var a="api/employeesEvaluationAll.xls?year="+f.year;window.open(a,"_self"),f.excelDownloading=!0,f.excelButtonDisabled=!0},f.onNgInit()}function MainController(a,b){a.go(b.isAuthenticated()?"home":"login")}function IndividualController(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=this;p.showInfo=!1,a.activeOption="increments",l.query({},function(a){p.employees=a}),p.ChartConf={labels:["","",""],datasets:[{label:"Maximo",fillColor:"rgba(0,0,0,0)",strokeColor:"red",pointColor:"rgba(0,0,0,0)",pointStrokeColor:"rgba(0,0,0,0)",pointHighlightFill:"rgba(0,0,0,0)",pointHighlightStroke:"rgba(0,0,0,0)",data:[3e4,3e4,3e4]},{label:"Media",fillColor:"rgba(0,0,0,0)",strokeColor:"green",pointColor:"rgba(0,0,0,0)",pointStrokeColor:"rgba(0,0,0,0)",pointHighlightFill:"rgba(0,0,0,0)",pointHighlightStroke:"rgba(0,0,0,0)",data:[25e3,25e3,25e3]},{label:"Minimo",fillColor:"rgba(0,0,0,0)",strokeColor:"black",pointColor:"rgba(0,0,0,0)",pointStrokeColor:"rgba(0,0,0,0)",pointHighlightFill:"rgba(0,0,0,0)",pointHighlightStroke:"rgba(0,0,0,0)",data:[2e4,2e4,2e4]},{label:"Salario",fillColor:"rgba(0,0,0,0)",strokeColor:"rgba(0,0,0,0)",pointColor:"blue",pointStrokeColor:"blue",pointHighlightFill:"blue",pointHighlightStroke:"blue",data:[0,23e3,0]}]},p.ChartOptions={responsive:!0,showTooltips:!1,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!1,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="tc-chart-js-legend"><% for (var i=0; i<datasets.length; i++){%><%if(datasets[i].label){%><li><%=datasets[i].label%></li><%}%><%}%></ul>'},p.changeEmployeeCombo=function(){p.showInfo=!1,""!==p.employeeId?k.query({employeeId:p.employeeId},function(a){p.retributions=a.filter(function(a){return null!==a.retribution}).map(function(a){var b=new Date(a.dateFrom);return{id:a.retribution.id,positionId:a.positionId,year:b.getFullYear()}}),p.retribution=""}):p.employeeCategories=null},p.changeYearsCombo=function(){""!==p.retribution?(p.showInfo=!1,o.get({retributionId:p.retribution.id},function(a){p.retributionInfo=a,p.retributionInfo.annualTotalIncome=p.retributionInfo.annualGrossIncome+p.retributionInfo.annualSocialProfits,o.getEmployeeInfo({employeeId:p.employeeId,categoryId:p.retribution.positionId,year:p.retribution.year},function(a){p.showInfo=!0,p.employeeInfo=a,null===a.wageBandLimits&&(a.wageBandLimits={minValue:0,medValue:0,maxValue:0});var b=a.wageBandLimits.minValue,c=a.wageBandLimits.medValue,d=a.wageBandLimits.maxValue,e=p.retributionInfo.annualGrossIncome;0===p.employeeInfo.positionIncreases.P1.length&&(p.employeeInfo.positionIncreases.P1=[0,0,0,0,0],p.employeeInfo.positionIncreases.P2=[0,0,0,0,0],p.employeeInfo.positionIncreases.P3=[0,0,0,0,0],p.employeeInfo.positionIncreases.P4=[0,0,0,0,0]);var f="P4";(b+c)/2>=e?f="P1":c>=e?f="P2":(d+c)/2>=e&&(f="P3"),p.P={actual:f,msg:"increments.position."+f};var g=0,i=p.employeeInfo.positionIncreases[f];switch(p.employeeInfo.evaluationMark){case"F":g=i[0];break;case"B":g=i[1];break;case"A":g=i[2];break;case"A+":g=i[3];break;case"A++":g=i[4]}p.percentIncrease=(g+p.employeeInfo.generalIncrease).toFixed(1),p.totalIncrease=(p.retributionInfo.annualGrossIncome*p.percentIncrease/100).toFixed(2),p.newGrossIncome=(p.retributionInfo.annualGrossIncome*(1+p.percentIncrease/100)).toFixed(2),p.fixedPercentIncrease=(g+p.employeeInfo.generalIncrease).toFixed(1),p.fixedTotalIncrease=(p.retributionInfo.annualGrossIncome*p.fixedPercentIncrease/100).toFixed(2);var j=" "+p.retributionInfo.currencyName;p.retributionInfo.annualGrossIncome=h("NumericFilter")(p.retributionInfo.annualGrossIncome)+j,p.retributionInfo.annualSocialProfits=h("NumericFilter")(p.retributionInfo.annualSocialProfits)+j,p.retributionInfo.annualTotalIncome=h("NumericFilter")(p.retributionInfo.annualTotalIncome)+j,p.ChartConf.datasets[0].data=[b,b,b],p.ChartConf.datasets[1].data=[c,c,c],p.ChartConf.datasets[2].data=[d,d,d],p.ChartConf.datasets[3].data=[e,e,e]},function(a){var b=a.data.msg||"increments.individual.modal.error";p.Modal={msg:b,title:"increments.individual.modal.error.title",button:"increments.individual.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")})})):p.retribution=null},p.goToEvaluation=function(){i.setId(p.employeeInfo.evaluationId),i.setModification(!1),i.setEvaluado({employeeId:p.employeeId,id:p.employeeInfo.evaluationId,creationDate:p.employeeInfo.evaluationCreationDate});var a=[];a.push(j.getEmployeeInfo({id:p.employeeId},function(a){p.employeeData=a}).$promise),a.push(m.getEvaluation({employeeId:p.employeeId,evaluationId:p.employeeInfo.evaluationId},function(a){p.evaluationData=a}).$promise),f.addPart("consult"),a.push(g.refresh()),e.all(a).then(function(){d.empleado={info:p.employeeData},d.leader=[],d.evaluation=p.evaluationData,c.go("consultEvaluation",{},{location:!0})})}}function MultipleController(a,b,c,d,e,f,g){var h=this;a.activeOption="increments",h.direction="",h.area="",h.year,h.confirmedServer=!1,h.showTables=!1,h.listDate=[],h.confirmedList=[];for(var i=new Date,j=2015;j<=i.getFullYear();j++)h.listDate.push(j);f.query({},function(a){h.directions=a}),h.changeDirectionCombo=function(){""!==h.direction&&(h.areas=[],g.getDirectionAreas({directionId:h.direction.id},function(a){h.areas=a},function(a){l(a.data.msg)}))},h.searchIncreases=function(){if(Mentoring.isEmpty(h.direction)||Mentoring.isUndefinedOrNull(h.year))return h.Modal={msg:"increments.multiple.modal.error.search",title:"increments.multiple.modal.error.title",button:"increments.multiple.modal.ok",action:function(){$("#myModal").modal("hide")}},void $("#myModal").modal("show");$("#pleaseWaitDialog").modal({backdrop:"static",show:!0}),h.showTables=!1,h.confirmedServer=!1;var a={directionId:h.direction.id,areaId:h.area,year:h.year,confirmed:h.confirmed};e.getMultipleData(a,function(a){h.showTables=!0,h.employeesInfo=a,a.filter(function(a){a.confirmed===!0&&(h.confirmedServer=!0,a.customSalaryIncrease=c("NumericFilter")(a.customSalaryIncrease,2),a.customSalaryIncreasePercent=c("NumericFilter")(a.customSalaryIncreasePercent,2))}),$("#pleaseWaitDialog").modal("hide")},function(a){$("#pleaseWaitDialog").modal("hide"),l(a.data.msg)})},h.changeValuePercent=function(a){var b=parseFloat(a.actualIncome),d=parseFloat(a.customSalaryIncreasePercent),e=parseFloat(a.salaryIncreasePercent)+d;isNaN(e)&&(d=0,e=0,l("increments.multiple.modal.error.percent.nan"));var f=b*d/100,g=b*e/100,h=b+g;a.customSalaryIncrease=c("NumericFilter")(f,2),a.customSalaryIncreasePercent=c("NumericFilter")(d,2),a.finalSalaryIncreasePercent=e,a.finalSalaryIncrease=g,a.finalIncome=h},h.changeValueNumeric=function(a){var b=parseFloat(a.actualIncome),d=parseFloat(a.customSalaryIncrease),e=100*d/b,f=parseFloat(a.salaryIncreasePercent)+e;isNaN(d)&&(d=0,e=0,f=0,l("increments.multiple.modal.error.salary.nan")),0>d&&(d=0,e=0,f=0,l("increments.multiple.modal.error.salary"));var g=b*f/100,h=b+g;a.customSalaryIncrease=c("NumericFilter")(d,2),a.customSalaryIncreasePercent=c("NumericFilter")(e,2),a.finalSalaryIncreasePercent=f,a.finalSalaryIncrease=g,a.finalIncome=h},h.changeConfirmed=function(a){if(a.confirmed)h.confirmedList.push(a);else{var b=0;for(b=0,length=h.confirmedList.length;b<length;b++){var c=h.confirmedList[b];if(c.categoryId===a.categoryId)break}h.confirmedList.splice(b,1)}},h.saveConfirmed=function(){h.confirmedList.length>0&&e.saveConfirmedData({directionId:h.direction.id},h.confirmedList,function(){h.Modal={msg:"increments.multiple.modal.confirmed.success",title:"increments.multiple.modal.confirmed.title",button:"increments.multiple.modal.ok",action:function(){b.location.reload()}},$("#myModal").modal("show")},function(a){l(a.data.msg)})},h.confirmIncrements=function(){var a=h.employeesInfo.filter(function(a){return a.confirmed});e.saveIncreases(a,function(){h.Modal={msg:"increments.multiple.modal.confirmed.successb",title:"increments.multiple.modal.confirmed.title",button:"increments.multiple.modal.ok",action:function(){b.location.reload()}},$("#myModal").modal("show")},function(a){l(a.data.msg)})},h.getPDFFile=function(){var a=k("pdf");window.open(a,"_self")},h.getXLSFile=function(){var a=k("excel");window.open(a,"_self")};var k=function(a){var b="api/employeeCatYear."+a+"?directionId="+h.direction.id+"&year="+h.year;return Mentoring.isEmpty(h.area)||(b+="&areaId="+h.area),Mentoring.isEmpty(h.confirmed)||(b+="&confirmed="+h.confirmed),b},l=function(a){a=a||"increments.multiple.modal.error",h.Modal={msg:a,title:"increments.multiple.modal.error.title",button:"increments.multiple.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")}}function IncrementsController(a,b,c,d,e,f,g){var h=this;h.direction=null,h.year=null,h.showTables=!1,h.saveChanges=!1,h.generalIncrease=0,a.activeOption="increments";var i={};b.getYears({},function(a){h.years=a}),f.query({},function(a){h.directions=a}),c.query({},function(a){i.evaluationMarks=a}),d.query({},function(a){i.wageBands=a}),e.query({},function(a){i.wageBandPositions=a}),h.searchPositions=function(){null!==h.direction&&null!==h.year?(h.showTables=!1,h.saveChanges=!1,h.generalIncrease=0,h.positions=l(),h.saveChanges=!0,b.query({year:h.year,direction:h.direction.id},function(a){a.noPositionIncreases&&h.year===Mentoring.getCurrentYear()?b.query({year:h.year-1,direction:h.direction.id},function(a){j(a,!0)}):j(a,!1),h.saveChanges=a.canSave})):(h.Modal={msg:"increments.increments.modal.warning.select",title:"increments.increments.modal.warning.title",button:"increments.increments.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show"))},h.savePositions=function(){var a=h.positions.business,c=h.positions.staff,d={v1:[],v2:[],v3:[],v4:[]};for(var e in a){var f=e.toLowerCase();for(var i in a[e])a[e][i].map(function(a){d[f].push(a)})}for(var e in c){var f=e.toLowerCase();for(var i in a[e])c[e][i].map(function(a){d[f].push(a)})}d.generalIncrease=h.generalIncrease,b.savePositions({direction:h.direction.id},d,function(){h.Modal={msg:"increments.increments.modal.success",title:"increments.increments.modal.success.title",button:"increments.increments.modal.ok",action:function(){$("#myModal").modal("hide"),g.location.reload()}},$("#myModal").modal("show")},function(){h.Modal={msg:"increments.increments.modal.error",title:"increments.increments.modal.error.title",button:"increments.increments.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")})};var j=function(a,b){if(!a.noPositionIncreases){h.positions=k(),h.generalIncrease=a.generalIncrease;for(var c in a){var d=a[c];Array.isArray(d)&&d.map(function(a){var d=h.positions.staff[c];a.isBusiness&&(d=h.positions.business[c]),b&&(a.id=null),d[a.name].push(a)})}}h.showTables=!0},k=function(){return{business:{v1:{P1:[],P2:[],P3:[],P4:[]},v2:{P1:[],P2:[],P3:[],P4:[]},v3:{P1:[],P2:[],P3:[],P4:[]},v4:{P1:[],P2:[],P3:[],P4:[]}},staff:{v1:{P1:[],P2:[],P3:[],P4:[]},v2:{P1:[],P2:[],P3:[],P4:[]},v3:{P1:[],P2:[],P3:[],P4:[]},v4:{P1:[],P2:[],P3:[],P4:[]}}}},l=function(){for(var a={business:{},staff:{}},b=i.evaluationMarks.filter(function(a){return"F"===a.code}).map(function(a){return a.id}),c=i.evaluationMarks.filter(function(a){return"B"===a.code}).map(function(a){return a.id}),d=i.evaluationMarks.filter(function(a){return"A"===a.code}).map(function(a){return a.id}),e=i.evaluationMarks.filter(function(a){return"A+"===a.code}).map(function(a){return a.id}),f=i.evaluationMarks.filter(function(a){return"A++"===a.code}).map(function(a){return a.id}),g=1;5>g;g++){var h="V"+g,j="V"+g;a.business[h]={},a.staff[h]={};var k={};i.wageBands.filter(function(a){return a.name===j}).map(function(a){a.business?k.business=a.id:k.staff=a.id});for(var l=1;5>l;l++){var m="P"+l,n=i.wageBandPositions.filter(function(a){return a.name===m});a.business[h][m]=[{positionId:n[0].id,bandName:j,bandId:k.business,isBusiness:!0,markId:b[0],markCode:"F",value:0},{positionId:n[0].id,bandName:j,bandId:k.business,isBusiness:!0,markId:c[0],markCode:"B",value:0},{positionId:n[0].id,bandName:j,bandId:k.business,isBusiness:!0,markId:d[0],markCode:"A",value:0},{positionId:n[0].id,bandName:j,bandId:k.business,isBusiness:!0,markId:e[0],markCode:"A+",value:0},{positionId:n[0].id,bandName:j,bandId:k.business,isBusiness:!0,markId:f[0],markCode:"A++",value:0}],a.staff[h][m]=[{positionId:n[0].id,bandName:j,bandId:k.staff,isBusiness:!1,markId:b[0],markCode:"F",value:0},{positionId:n[0].id,bandName:j,bandId:k.staff,isBusiness:!1,markId:c[0],markCode:"B",value:0},{positionId:n[0].id,bandName:j,bandId:k.staff,isBusiness:!1,markId:d[0],markCode:"A",value:0},{positionId:n[0].id,bandName:j,bandId:k.staff,isBusiness:!1,markId:e[0],markCode:"A+",value:0},{positionId:n[0].id,bandName:j,bandId:k.staff,isBusiness:!1,markId:f[0],markCode:"A++",value:0}]}}return a}}function WageLimitsController(a,b,c,d){var e=this;a.activeOption="increments",e.canSave=!0,e.direction=null,e.directions=[],e.limits=[],e.currency="",e.yearHTML=Mentoring.getCurrentYear(),e.showTables=!1,d.query({},function(a){e.directions=a}),e.selectDirection=function(){null===e.direction?(e.showTables=!1,e.Modal={msg:"increments.limits.modal.warning.select",title:"increments.limits.modal.warning.title",button:"increments.limits.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")):!function(){e.showTables=!1,e.canSave=!1;var a=Mentoring.getCurrentYear();c.query({year:a,direction:e.direction.id},function(b){e.currency=e.direction.currencySymbol,0==b.limits.length?c.query({year:a-1,direction:e.direction.id},function(a){g(a,!0)},h):g(b,!1),e.canSave=b.canSave},h)}()},e.saveLimits=function(){if(f(e.limits)){var a=[],d=e.limits.business;for(var g in d)a.push(d[g]);var h=e.limits.staff;for(var g in h)a.push(h[g]);c.saveLimits(a,function(){e.Modal={msg:"increments.limits.modal.success",title:"increments.limits.modal.success.title",button:"increments.limits.modal.ok",action:function(){b.location.reload()}},$("#myModal").modal("show")},function(){e.Modal={msg:"increments.limits.modal.error",title:"increments.limits.modal.error.title",button:"increments.limits.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")})}else e.Modal={msg:"increments.limits.modal.form.error",title:"increments.limits.modal.error.title",button:"increments.limits.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")};var f=function(a){var b=!0,c=$("form").scope().LimitsForm,d=a.business,e=a.staff;for(var f in d){var g=!0,h=d[f];(h.minValue>=h.medValue||h.medValue>=h.maxValue)&&(b=!1,g=!1);var i="Business."+f+".";c[i+"minValue"].$setValidity("business",g),c[i+"medValue"].$setValidity("business",g),c[i+"maxValue"].$setValidity("business",g)}for(var f in e){var g=!0,h=e[f];h.minValue>=h.medValue&&h.medValue>=h.maxValue&&(b=!1,g=!1);var i="Staff."+f+".";c[i+"minValue"].$setValidity("business",g),c[i+"medValue"].$setValidity("business",g),c[i+"maxValue"].$setValidity("business",g)}return b},g=function(a,b){var c=a.limits;e.positions={business:{},staff:{}},e.limits={business:{},staff:{}};var d;d=0===c.length?a.defaultLimits:c,d.forEach(function(a){var c=a.isBusiness?e.limits.business:e.limits.staff;c[a.bandName]=a,b&&(c[a.bandName].id=null)}),e.showTables=!0},h=function(){e.Modal={msg:"increments.limits.modal.error",title:"increments.limits.modal.error.title",button:"increments.limits.modal.ok",action:function(){$("#myModal").modal("hide")}},$("#myModal").modal("show")}}function InformationController(a,b,c){var d="InfoV&Y/",e="information.maps.business.",f="information.maps.staff.",g=this;a.activeOption="information",g.imgUrl=[],g.getCompetencesUrl=function(a){var c="",e=b.use();switch(a){case 1:c="es"===e?"COMPETENCIAS_GESTION.PDF":"MANAGEMENT-COMPETENCES-VASSIT.PDF";break;case 2:c="es"===e?"COMPETENCIAS_MANDO.PDF":"MANAGEMENT&LEADERSHIP-COMPETENCES-VASSIT.PDF"}return d+"PDFs/"+c},g.getMapImgs=function(){c.identity().then(function(a){var c=a.organization;switch(c){case"Serbatic":g.imgUrl.push({text:b.instant(e+"Serbatic"),url:d+"IMGs/MapaSerbatic.png"});break;case"VASSDigital":g.imgUrl.push({text:b.instant(e+"VASSDigital"),url:d+"IMGs/MapaVASSDigital.png"});break;case"VASS":g.imgUrl.push({text:b.instant(e+"VASS"),url:d+"IMGs/MapaNegocio_es.png"},{text:b.instant(f+"VASS"),url:d+"IMGs/MapaStaff_es.png"},{text:b.instant(e+"VASSIT"),url:d+"IMGs/MapaNegocio_en.png"},{text:b.instant(e+"LATAM"),url:d+"IMGs/MapaNegocio_latam.png"})}})},g.initPopup=function(){$(".popup_image").magnificPopup({type:"image",closeOnContentClick:!0,closeBtnInside:!1,fixedContentPos:!0,mainClass:"mfp-no-margins mfp-with-zoom",image:{verticalFit:!0},zoom:{enabled:!0,duration:300}})}}function CTModelController(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=this;a.activeOption="information",u.initCtrl=function(){"login"!==c.current.name&&(a.activeOption="information",h.identity().then(function(a){if(null==a&&c.go("login"),z(a.roles)||a.isLeader){if(u.linkPDF="InfoV&Y/PDFs/COMPONENTES-TEMPERAMENTALES.pdf",!Mentoring.isUndefinedOrNull(a)&&!Mentoring.isUndefinedOrNull(a.roles)){if(u.leader={},u.evaluation={},u.empleado={},u.empleadoLeaderUser={},u.isLeader=a.isLeader,u.roleRRHH||u.roleGERENTE||u.roleDIRECTOR||u.roleDIRECTORG||u.roleADMIN?u.isVisibleMando=!0:u.roleUSER&&(u.isVisibleLeader=!0,u.empleadosLeaderUser=i.query({leaderId:a.employeeId})),u.roleADMIN||u.roleDIRECTORG){var f=[];f.push(j.query({},function(a){u.empleados=a}).$promise),f.push(k.query({},function(a){u.leaders=a}).$promise),e.all(f).then(function(){u.empleado.info&&u.change(u.empleado.info.id)})}u.roleDIRECTOR&&(u.empleados=l.query({directionId:a.employeeId}),u.leaders=m.query({directionId:a.employeeId})),u.roleGERENTE&&(u.empleados=n.query({managerId:a.employeeId}),u.leaders=o.query({managerId:a.employeeId})),u.roleRRHH&&(p.query(function(b){u.empleados=b,r.query({employeeId:a.employeeId},function(b){angular.forEach(b,function(b){b.id===a.employeeId&&u.empleados.push(b)})})}),q.query(function(a){u.leaders=a}))}""!==d.leaderId&&""!==d.employeeId&&(u.employeeId=parseInt(d.employeeId),u.leaderId=parseInt(d.leaderId),u.getCTModelsEmployee(u.employeeId))}else b.error("Usuario intentado acceder a un area donde no tiene autorizacion -> "+c.current.name),c.go("home")}))},u.getCTModelsEmployee=function(a){a?(u.employeeId=a,t.getByEmployeeId({employeeId:a},w)):Mentoring.isUndefinedOrNull(u.leaderId)?u.CTResults=null:u.changeEvaluator(u.leaderId)},u.changeEvaluator=function(a){u.leaderId=a,u.autoEvaluation=null,u.finalEvaluation=null,Mentoring.isUndefinedOrNull(u.empleadosCopy)&&(u.empleadosCopy=angular.copy(u.empleados)),Mentoring.isUndefinedOrNull(a)?u.empleados=u.empleadosCopy:(t.getLeaderEvaluations({leaderId:a},w),s.query({leaderId:a},function(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(a[c].employeeId);u.empleados=u.empleadosCopy.filter(function(a){return b.indexOf(a.id)>=0})}))},u.showResult=function(a){u.newCtResult=!1,u.CTResult=a,x(),u.CTResults.map(function(a){delete a.selected}),a.selected=!0,t.getCTAnswers({employeeId:a.employeeId,answersId:a.answersId},function(a){for(var b=function(b){var c=a[b];u.Questions.filter(function(a){return a.id===c.ctQuestion.id}).map(function(a){for(var b=0,d=u.Answers.length;d>b;b++){var e=u.Answers[b];if(e.value===c.value){a.value=e.label;break}}})},c=0,d=a.length;d>c;c++)b(c,d)})},u.newCTResult=function(){u.newCtResult=!0,u.ResultEvaluation=null,u.CTResults.map(function(a){delete a.selected}),x(),u.CTResult={employeeId:u.empleado.info.employeeId}},u.calculateCTResult=function(){var a=v();return a?void t.obtainResult(u.CTResult,function(a){u.ResultEvaluation={principal:a.principal,second:a.second,third:a.third,control:a.control},u.ResultEvaluation.principal["class"]=A(u.ResultEvaluation.principal.key),u.ResultEvaluation.second["class"]=A(u.ResultEvaluation.second.key),u.ResultEvaluation.third["class"]=A(u.ResultEvaluation.third.key);var b=u.ResultEvaluation.control;b=3>=b?"information.ct.control.muybajo":b>=4&&6>=b?"information.ct.control.mediobajo":b>=7&&9>=b?"information.ct.control.medio":b>=10&&13>=b?"information.ct.control.medioalto":"information.ct.control.alto"},function(){y(),u.Modal.msg="information.ct.modal.error.calculate",$("#myModal").modal("show")}):(y(),u.Modal.msg="information.ct.modal.error.combo",void $("#myModal").modal("show"))},u.saveCTResult=function(){var a=v();return a?void t.saveCTResult(u.CTResult,function(){y(),u.Modal.title="information.ct.modal.success.title",u.Modal.msg="information.ct.modal.success.save",u.Modal.action=function(){c.go(c.current,{leaderId:u.leaderId,employeeId:u.employeeId},{reload:!0,notify:!0})},$("#myModal").modal("show")},function(){y(),u.Modal.msg="information.ct.modal.error.save",$("#myModal").modal("show")}):(y(),u.Modal.msg="information.ct.modal.error.combo",void $("#myModal").modal("show"))};var v=function(){var a=angular.copy(u.Questions),b=!1;return u.Questions.map(function(a){Mentoring.isUndefinedOrNull(a.value)||"?"===a.value?(a.styleClass="ct-model-error",b=!0):a.styleClass=""}),b?!1:(u.CTResult.answers=[],u.Questions.map(function(a){var b=a.value;delete a.value,u.CTResult.answers.push({ctQuestion:{id:a.id,ctModel:{id:a.ctModel.id}},value:b})}),u.Questions=angular.copy(a),!0)},w=function(a){u.CTResults=[],a.map(function(a){var b=a.employee.firstSurname+" "+a.employee.secondSurname+", "+a.employee.name,c=a.leader.firstSurname+" "+a.leader.secondSurname+", "+a.leader.name,d=a.control;d=3>=d?"information.ct.control.muybajo":d>=4&&6>=d?"information.ct.control.mediobajo":d>=7&&9>=d?"information.ct.control.medio":d>=10&&13>=d?"information.ct.control.medioalto":"information.ct.control.alto",u.CTResults.push({employeeId:a.employee.id,answersId:a.answersId,principal:a.principal.key,second:a.second.key,third:a.third.key,control:d,principalClass:A(a.principal.key),secondClass:A(a.second.key),thirdClass:A(a.third.key),date:a.dateAdd,employee:b,leader:c})})},x=function(){void 0===u.Answers&&(u.Answers=[{value:2,label:f.instant("information.ct.answer.yes")},{value:0,label:f.instant("information.ct.answer.no")},{value:1,label:f.instant("information.ct.answer.na")}]),u.Questions=[],u.Models={},0===u.Questions.length&&t.getQuestions({},function(a){u.Questions=a,a.map(function(a){switch(a.ctModel.id){case 1:u.Models.red=a.ctModel;break;case 2:u.Models.yellow=a.ctModel;break;case 3:u.Models.blue=a.ctModel;break;case 4:u.Models.green=a.ctModel;break;case 5:u.Models.orange=a.ctModel;break;case 6:u.Models.pink=a.ctModel;break;case 7:u.Models.grey=a.ctModel}})})},y=function(){u.Modal={title:"information.ct.modal.error.title",button:"information.ct.modal.ok",action:function(){$("#myModal").modal("hide")}}},z=function(a){return u.roleUSER=a.indexOf("ROLE_USER")>-1,u.roleRRHH=a.indexOf("ROLE_RRHH")>-1,u.roleGERENTE=a.indexOf("ROLE_GERENTE")>-1,u.roleDIRECTOR=a.indexOf("ROLE_DIRECTOR")>-1,u.roleDIRECTORG=a.indexOf("ROLE_DIRECTORG")>-1,u.roleADMIN=a.indexOf("ROLE_ADMIN")>-1,u.roleADMIN||u.roleRRHH||u.roleGERENTE||u.roleDIRECTOR||u.roleDIRECTORG;

},A=function(a){return a.indexOf("red")>-1?"circle-red":a.indexOf("yellow")>-1?"circle-yellow":a.indexOf("blue")>-1?"circle-blue":a.indexOf("green")>-1?"circle-green":a.indexOf("orange")>-1?"circle-orange":a.indexOf("pink")>-1?"circle-pink":a.indexOf("grey")>-1?"circle-grey":void 0};u.initCtrl()}function AssignCompetencesValues(a,b,c,d,e,f,g,h,i,j,k){var l,m=this;m.initCtrl=function(){"login"!=e.current.name&&(g.identity().then(function(){a.roleRRHH||a.roleAdmin?(m.wageBand=null,m.position=null,h.query({},function(a){m.positions=a.map(function(a){var b=f.instant(a.description)+" - "+f.instant(a.nameKey);return a.name=b,a})}),i.query({},function(a){m.wageBands=a.filter(function(a){return 0===a.outsourcing}).map(function(a){return 0===a.business&&(a.name=a.name+" Staff"),a})})):(c.error("Usuario intentado acceder a un area donde no tiene autorizacion -> "+e.current.name),e.go("home"))}),m.Modal={})},m.changeWageBandCombo=function(){Mentoring.isUndefinedOrNull(l)&&(l=angular.copy(m.positions)),m.positions=Mentoring.isUndefinedOrNull(m.wageBand)?angular.copy(l):l.filter(function(a){return a.wageBandId===m.wageBand.id})},m.changePositionCombo=function(){Mentoring.isUndefinedOrNull(m.position)||(Mentoring.isUndefinedOrNull(m.states)?k.query({},function(a){m.states=a,m.states.map(function(a){var b="Estado"+a.id;a.text=f.instant(b)}),n()}):n())},m.saveWeightQuestions=function(){var a=angular.copy(m.weightQuestions),b=0;return m.weightQuestions.map(function(a){delete a.stateId,b+=a.value}),25===m.weightQuestions.length&&57!==b||18===m.weightQuestions.length&&42!==b?(o({msg:"assign.competences.modal.error.sum",title:"assign.competences.modal.error.form.title"}),void(m.weightQuestions=angular.copy(a))):(j.saveWeightQuestions(m.weightQuestions,function(){o({msg:"assign.competences.modal.save.ok",title:"assign.competences.modal.save.ok.title"})},function(){o({msg:"assign.competences.modal.save.error",title:"assign.competences.modal.save.error"})}),void(m.weightQuestions=angular.copy(a)))},m.getQuestionCode=function(a){m.codePregunta=a,m.definicionInfo=d.trustAsHtml(f.instant("evaluation.info."+a+".comportamientoInfo"))};var n=function(){j.getByPositionId({positionId:m.position.id},function(a){var c=0,d=0,e=void 0;a.map(function(a){if(m.locked=1===a.locked?!0:!1,e=a.year,c!==a.question.competence.competenceCode){var f="evaluation."+a.question.competence.competenceCode;c=a.question.competence.competenceCode,a.competence=b("translate")(f)}if(d!==a.question.pillar.pillarCode){d=a.question.pillar.pillarCode;var g="evaluation."+a.question.pillar.pillarCode;a.pillar=b("translate")(g)}a.stateId=""+a.value}),m.weightQuestions=a;var f=new Date;m.sameYear=e===f.getFullYear()})};m.changeState=function(a){a.value=parseInt(a.stateId)};var o=function(a){Mentoring.isUndefinedOrNull(m.Modal)&&(m.Modal={}),m.Modal.msg=a.msg,m.Modal.title=a.title,m.Modal.button=a.button||"assign.competences.modal.ok",m.Modal.action=a.action||function(){$("#myModal").modal("hide")},$("#myModal").modal("show")};m.initCtrl()}function CustomCompetencesFilter(){return function(a,b,c){var d=[];return a.map(function(a){var b=c.question.competenceId;3===b?(4===a.id||6===a.id)&&d.push(a):(1===a.id||3===a.id||5===a.id)&&d.push(a)}),d}}LanguageController.$inject=["$translate","Language"],LoginController.$inject=["$cookies","$state","Auth","Activate","AuditService"],AllocationController.$inject=["$rootScope","$filter","$translate","EmployeeEvaluableIdResource","EmployeeLeaderResource","Allocation","Allocations","AllocationsLeader","AllocationSave","AllocationsLE"],AuditsController.$inject=["$rootScope","$filter","AuditsService"],ConfigurationController.$inject=["$rootScope","ConfigurationService"],HealthController.$inject=["$rootScope","HealthService"],MetricsController.$inject=["$rootScope","$scope","HealthService"],RolesController.$inject=["$rootScope","EmpleadosRL","Roles","RolesUsuario","Guardar","Borrar"],ConsultController.$inject=["$rootScope","$state","$q","$previousState","$stateParams","Principal","EvaluationsCn","EmpleadosCn","EvaluationsAllEmployees","isEvaluationDate","isFinalEvaluationDate","EvaluationYear","EvaluationsMandoCn","EvaluationsConsultLeader","EmployeeEvaluationResource","EvaluationEmployeeLeaderResource","EmployeeEvaluableIdResource","EmployeeLeaderResource","EmployeesDIRECTOR","LeadersDIRECTOR","EmployeesGERENTE","LeadersGERENTE","EmployeesRRHH","LeadersRRHH","SharingEvaluationService","IsModificableService"],ConsultEvaluationController.$inject=["$scope","$timeout","$sce","$state","$stateParams","$window","$previousState","Principal","$translate","QuestionsResource","StatesResource","AnswersResource","CompetencesResource","PillarsResource","SharingEvaluationService","EvaluationId","EmployeeIsLeaderResource","AnswersSelect","AnswersEval","isEvaluationDate","isFinalEvaluationDate","CurrentAllocation","CalculateEvaluationResult"],ConsultEvaluationAutoevaluationController.$inject=["$scope","$timeout","$state","$q","$sce","$translate","StatesResource","CompetencesResource","PillarsResource","QuestionsResource","AnswersResource","AnswersSelect","Principal","EvaluationsCn","EmpleadosCn","EvaluationsMandoCn","EvaluationsConsultLeader","AllocationsLeader","EmployeeEvaluableIdResource","EmployeeLeaderResource","EmployeesDIRECTOR","LeadersDIRECTOR","EmployeesGERENTE","ConsultEvaluationAutoevaluationService","LeadersGERENTE","EmployeesRRHH","LeadersRRHH","IsModificableService"],EvaluationController.$inject=["$rootScope","$sce","$state","Principal","$translate","QuestionsResource","LastEvaluationAssigned","GetLastAutoEvalByEmployeeId","LastEvaluationAssignedWithEvalType","StatesResource","AnswersSelect","AnswersEval","EmpleadosEvaluables","EvaluationEmployeeLeaderResource","AnswersResource","EmpleadosAE","EmployeeEvaluationResource","CompetencesResource","PillarsResource","isEvaluationDate","isFinalEvaluationDate","EmployeeIsLeaderResource","EmployeesRRHH","EmpleadosCn","EmployeesDIRECTOR","PrintService"],EvaluationleaderController.$inject=["QuestionsResource","StatesResource","AnswersResourceEL","AnswersResource","Empleados","EmployeeEvaluationResource","CompetencesResource","PillarsResource"],LeadersEvaluationsController.$inject=["$rootScope","$state","$translate","Principal","EmployeeLeaderResource","LeadersEvaluationsService"],EmployeesEvaluationsController.$inject=["$rootScope","$state","$translate","Principal","Directions","Areas","EmployeesEvaluationService"],AllEvaluationsController.$inject=["$rootScope","$state","$translate","Principal","EmployeesEvaluationService"],MainController.$inject=["$state","Principal"],IndividualController.$inject=["$rootScope","$scope","$state","$stateParams","$q","$translatePartialLoader","$translate","$filter","SharingEvaluationService","EmpleadosCn","EmployeesCategory","Employees","EmployeeEvaluationResource","EvaluationsCn","Retribution"],MultipleController.$inject=["$rootScope","$window","$filter","EmployeesCategoryByYear","EmployeeMultiple","Directions","Areas"],IncrementsController.$inject=["$rootScope","PositionIncreases","EvaluationMarkService","WageBandService","WageBandPositionService","DirectionsService","$window"],WageLimitsController.$inject=["$rootScope","$window","WageBandLimitsService","DirectionsService"],InformationController.$inject=["$rootScope","$translate","Principal","Directions"],CTModelController.$inject=["$rootScope","$log","$state","$stateParams","$q","$translate","$window","Principal","EvaluationsConsultLeader","EmployeeEvaluableIdResource","EmployeeLeaderResource","EmployeesDIRECTOR","LeadersDIRECTOR","EmployeesGERENTE","LeadersGERENTE","EmployeesRRHH","LeadersRRHH","EmpleadosCn","AllocationsLeader","CTModelService"],AssignCompetencesValues.$inject=["$rootScope","$filter","$log","$sce","$state","$translate","Principal","PositionService","WageBandService","WeightQuestionService","StatesResource"];var Mentoring=function(){var a=new Date,b={query:{method:"GET",isArray:!0},get:{method:"GET",transformResponse:function(a){return a=angular.fromJson(a)}},update:{method:"PUT"}},c={query:{method:"GET",isArray:!0},get:{method:"GET",transformResponse:function(a){return a=angular.fromJson(a)}}},d={get:{method:"GET",transformResponse:function(a){return a}}},e=function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return""},f=function(a){return void 0===a||null===a},g=function(a){var b=f(a);return"string"==typeof a&&""===a&&(b=!0),b},h=function(){return a.getFullYear()};return{resourceHandler:b,resourceHandlerGET:c,resourceHandlerGETNoTransform:d,getCookie:e,isUndefinedOrNull:f,isEmpty:g,getCurrentYear:h}}();angular.module("mentoringApp",["LocalStorageModule","tmh.dynamicLocale","ngResource","ui.router","ngCookies","pascalprecht.translate","ngCacheBuster","infinite-scroll","tc.chartjs","ct.ui.router.extras","ngSanitize"]),angular.module("mentoringApp").config(["$provide",function(a){a.decorator("$log",["$delegate",function(a){var b=a.error;return a.error=function(){var a=[].slice.call(arguments),c="string"==typeof a[0]?a[0]:"",d={msg:c,level:"ERROR"},e=Mentoring.getCookie("CSRF-TOKEN");$.ajax({url:"api/sendLog",method:"POST",data:JSON.stringify(d),contentType:"application/json; charset=utf-8",headers:{"X-CSRF-TOKEN":e}});var f={type:"XHR-Error",msg:c};$.ajax({url:"api/webaudit",method:"POST",data:JSON.stringify(f),contentType:"application/json; charset=utf-8",headers:{"X-CSRF-TOKEN":e}}),b.apply(null,a)},a}])}]).config(["$stateProvider","$urlRouterProvider","$httpProvider","$translateProvider","httpRequestInterceptorCacheBusterProvider",function(a,b,c,d,e){c.defaults.xsrfCookieName="CSRF-TOKEN",c.defaults.xsrfHeaderName="X-CSRF-TOKEN",c.interceptors.push(["$q","$log",function(a,b){return{responseError:function(c){return window.location.href.indexOf("login")<0&&b.error(c.config.url+" - "+c.status+" "+c.statusText+": "+c.data.msg),a.reject(c)}}}]),e.setMatchlist([/.*api.*/],!0),b.otherwise(function(a,b){var c=a.get("Principal");b.url(c.isAuthenticated()?"/home":"/login")}),a.state("public",{"abstract":!0,views:{"header@":{templateUrl:"scripts/components/header/header.html"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("global"),b.addPart("language"),a.refresh()}]}}).state("site",{"abstract":!0,views:{"header@":{templateUrl:"scripts/components/header/header.html"}},resolve:{authorize:["Auth",function(a){return a.authorize()}],translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("global"),b.addPart("language"),b.addPart("positions"),b.addPart("states"),a.refresh()}]}}).state("main",{parent:"site",name:"main",url:"/",data:{roles:[]},views:{"content@":{controller:"MainController"}},resolve:{mainTranslatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("main"),a.refresh()}]}}),d.useLoader("$translatePartialLoader",{urlTemplate:"i18n/{part}/{lang}.json"}),d.preferredLanguage("es"),d.useCookieStorage()}]).config(["tmhDynamicLocaleProvider",function(a){a.localeLocationPattern("bower_components/angular-i18n/angular-locale_{{locale}}.js"),a.useCookieStorage("NG_TRANSLATE_LANG_KEY")}]),angular.module("mentoringApp").constant("ENV","dev").constant("VERSION","1.0.0-SNAPSHOT"),angular.module("mentoringApp").run(["$rootScope","$window","$state","$translate","Auth","Principal","Language","AuditService","ENV","VERSION",function(a,b,c,d,e,f,g,h,i,j){a.ENV=i,a.VERSION=j,a.$on("$stateChangeStart",function(b,h,i){a.toState=h,a.toStateParams=i,""!==c.current.name&&"login"!==c.current.name&&f.isIdentityResolved()&&e.authorize(),g.getCurrent().then(function(a){d.use(a)})}),a.$on("$stateChangeSuccess",function(c,e,f,g,i){var j="global.title";a.previousStateName=g.name,a.previousStateParams=i,"login"!==e.name&&h.audit({type:"State-Change",element:e.url}),d(j).then(function(a){b.document.title=a})}),a.$on("$viewContentLoaded",function(){""!==c.current.name&&"login"!==c.current.name&&"logout"!==c.current.name&&f.identity().then(function(b){if(b){var c=document.querySelector("#content");if(window.MutationObserver){var d=new MutationObserver(function(a){var b=!1;a.forEach(function(a){angular.forEach(a.addedNodes,function(a){if(!b){var c=$(a);b=c.find("a, select, button").length>0}})}),b&&k()}),e={childList:!0,subtree:!0};d.observe(c,e),k()}a.account=b,a.bodylayout="vass",Mentoring.isUndefinedOrNull(b)||Mentoring.isUndefinedOrNull(b.organization)||("Serbatic"===b.organization?a.bodylayout="serbatic":"VASSDigital"===b.organization&&(a.bodylayout="vassdigital")),a.isAuthenticated=f.isAuthenticated(),a.isLeader=1==b.isLeader?!0:!1,a.roleAdmin=f.isInRole("ROLE_ADMIN"),a.roleRRHH=f.isInRole("ROLE_RRHH")||f.isInRole("ROLE_ADMIN")||f.isInRole("ROLE_DIRECTORG")}})}),a.back=function(){"authenticate"===a.previousStateName||null===c.get(a.previousStateName)?c.go("main"):c.go(a.previousStateName,a.previousStateParams)};var k=function(){var a=$("#content");a.find('form button[type="submit"]').unbind("click.submit").bind("click.submit",function(a){$(a.target).parents("form").addClass("ng-sent")}),a.find("a").unbind("click.webaudit").bind("click.webaudit",function(a){h.audit({location:c.$current.url.source,type:"Click",element:a.target.toString()})}),a.find("button").unbind("click.webaudit").bind("click.webaudit",function(a){var b=a.target,d=null!=b.attributes["ng-click"]?b.attributes["ng-click"]:b.attributes["data-ng-click"],e=void 0!=d?d.value:"Default Click";h.audit({location:c.$current.url.source,type:"Click",element:a.target.toString(),msg:e})}),a.find("select").unbind("change.webaudit").bind("change.webaudit",function(a){var b=a.target,d=null!=b.attributes["ng-model"]?b.attributes["ng-model"]:b.attributes["data-ng-model"],e=void 0!=d?d.value+"=":"Selection: ";h.audit({location:c.$current.url.source,type:"Change",element:a.target.toString(),msg:e+a.target.value})})}}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("account",{"abstract":!0,parent:"site"})}]),angular.module("mentoringApp").factory("Language",["$q","$translate","LANGUAGES",function(a,b,c){return{getCurrent:function(){var c=a.defer(),d=b.storage().get("NG_TRANSLATE_LANG_KEY");return angular.isUndefined(d)&&(d="es"),c.resolve(d),c.promise},getAll:function(){var b=a.defer();return b.resolve(c),b.promise}}}]).constant("LANGUAGES",["es","en"]),angular.module("mentoringApp").controller("LanguageController",LanguageController),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("login",{parent:"public",url:"/login",data:{roles:[]},views:{"header@":{template:"<div></div>"},"content@":{templateUrl:"scripts/account/login/login.html",controller:"LoginController",controllerAs:"loginCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("login"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("LoginController",LoginController),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("logout",{parent:"public",url:"/logout",data:{roles:[]},views:{"content@":{controller:"LogoutController"}}})}]),angular.module("mentoringApp").controller("LogoutController",["$state","Auth",function(a,b){b.logout(),a.go("login")}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("sessions",{parent:"account",url:"/sessions",data:{roles:["ROLE_USER"],pageTitle:"global.menu.account.sessions"},views:{"content@":{templateUrl:"scripts/account/sessions/sessions.html",controller:"SessionsController"},"header@":{templateUrl:"scripts/components/header/header.html",controller:"HeaderController"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("sessions"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("SessionsController",["$scope","Sessions","Principal",function(a,b,c){c.identity().then(function(b){a.account=b}),a.success=null,a.error=null,a.sessions=b.getAll(),a.invalidate=function(c){b["delete"]({series:encodeURIComponent(c)},function(){a.error=null,a.success="OK",a.sessions=b.getAll()},function(){a.success=null,a.error="ERROR"})}}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("settings",{parent:"account",url:"/settings",data:{roles:["ROLE_USER"],pageTitle:"global.menu.account.settings"},views:{"content@":{templateUrl:"scripts/account/settings/settings.html",controller:"SettingsController"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("settings"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("SettingsController",["$scope","Principal","Auth",function(a,b,c){a.success=null,a.error=null,b.identity().then(function(b){a.settingsAccount=b}),a.save=function(){c.updateAccount(a.settingsAccount).then(function(){a.error=null,a.success="OK",b.identity().then(function(b){a.settingsAccount=b})})["catch"](function(){a.success=null,a.error="ERROR"})}}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("allocation",{name:"allocation",parent:"site",url:"/allocation",data:{roles:["ROLE_ADMIN","ROLE_RRHH","ROLE_DIRECTORG"],pageTitle:"allocations.title"},views:{"content@":{templateUrl:"scripts/allocation/allocation.html",controller:"AllocationController",controllerAs:"allocationCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("allocation"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("AllocationController",AllocationController),angular.module("mentoringApp").factory("Allocations",["$resource",function(a){return a("api/allocation/:employeeId",{},Mentoring.resourceHandler)}]).factory("CurrentAllocation",["$resource",function(a){return a("api/allocation/current/:employeeId",{},Mentoring.resourceHandler)}]).factory("AllocationsLeader",["$resource",function(a){return a("api/allocationLeader/:leaderId",{},Mentoring.resourceHandler)}]).factory("AllocationsLE",["$resource",function(a){return a("api/allocationLE/:leaderId/:employeeId",{},Mentoring.resourceHandler)}]).factory("AllocationSave",["$resource",function(a){return a("api/allocation",{},{guardar:{method:"POST"},update:{url:"api/updallocation",method:"PUT"}})}]).factory("Allocation",function(){return{agrupar:function(a,b,c,d){var e={id:a,employeeId:b,leaderId:c,dateFrom:d};return angular.toJson(e)},actualizarFecha:function(a){$("#dateFrom").datepicker("option","minDate",new Date(a))}}}),angular.module("mentoringApp").factory("Auth",["$rootScope","$state","$q","$translate","Activate","Principal","AuthServerProvider","$log",function(a,b,c,d,e,f,g,h){return{login:function(a,b){var d=b||angular.noop,i=c.defer();return g.login(a).then(function(a){return f.identity(!0).then(function(){h.log("Usuario identificado correctamente")}),i.resolve(a),d()})["catch"](function(a){return this.logout(),e.get({key:"KEY"}),i.reject(a),d(a)}.bind(this)),i.promise},logout:function(){g.logout(),f.authenticate(null)},authorize:function(c){return f.identity(c).then(function(){var c=f.isAuthenticated();a.toState.data.roles&&a.toState.data.roles.length>0&&!f.isInAnyRole(a.toState.data.roles)&&(c?b.go("accessdenied"):(a.returnToState=a.toState,a.returnToStateParams=a.toStateParams,b.go("login")))})}}}]),angular.module("mentoringApp").factory("Principal",["$q","Account",function(a,b){var c,d=!1;return{isIdentityResolved:function(){return angular.isDefined(c)},isAuthenticated:function(){return d},isInRole:function(a){return d&&c&&c.roles?-1!==c.roles.indexOf(a):!1},isInAnyRole:function(a){if(!d||!c.roles)return!1;for(var b=0;b<a.length;b++)if(this.isInRole(a[b]))return!0;return!1},authenticate:function(a){c=a,d=null!==a},identity:function(e){var f=a.defer();return e===!0&&(c=void 0),angular.isDefined(c)?(f.resolve(c),f.promise):(b.get().$promise.then(function(a){c=a.data,d=!0,f.resolve(c)})["catch"](function(){c=null,d=!1,f.resolve(c)}),f.promise)}}}]),function(){angular.module("mentoringApp").factory("Account",["$resource",function(a){return a("api/account",{},{get:{method:"GET",params:{},isArray:!1,interceptor:{response:function(a){return a}}}})}])}(),function(){angular.module("mentoringApp").factory("Activate",["$resource",function(a){return a("api/activate",{},{get:{method:"GET",params:{},isArray:!1}})}])}(),function(){angular.module("mentoringApp").factory("Password",["$resource",function(a){return a("api/account/change_password",{},{})}])}(),function(){angular.module("mentoringApp").factory("Register",["$resource",function(a){return a("api/register",{},{})}])}(),function(){angular.module("mentoringApp").factory("Sessions",["$resource",function(a){return a("api/account/sessions/:series",{},{getAll:{method:"GET",isArray:!0}})}])}(),function(){angular.module("mentoringApp").factory("User",["$resource",function(a){return a("api/users/:login",{},{query:{method:"GET",isArray:!0},get:{method:"GET",transformResponse:function(a){return a=angular.fromJson(a)}}})}])}(),angular.module("mentoringApp").factory("AuthServerProvider",["$log","$http","localStorageService","$window",function(a,b,c,d){return{login:function(e){var f="j_username="+e.company+":"+encodeURIComponent(e.username)+"&j_password="+encodeURIComponent(e.password)+"&submit=Login";return b.post("api/authentication",f,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a){return c.set("token",d.btoa(e.username+":"+e.password)),a}).error(function(){a.error("Login error")})},logout:function(){b.post("api/logout").success(function(a){return c.clearAll(),a})},getToken:function(){var a=c.get("token");return a},hasValidToken:function(){var a=this.getToken();return!!a}}}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("admin",{"abstract":!0,parent:"site"})}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("audits",{name:"audits",parent:"admin",url:"/audits",data:{roles:["ROLE_ADMIN"],pageTitle:"audits.title"},views:{"content@":{templateUrl:"scripts/configuration/audits/audits.html",controller:"AuditsController",controllerAs:"auditsCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("audits"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("AuditsController",AuditsController),angular.module("mentoringApp").factory("AuditsService",["$http",function(a){return{findAll:function(){return a.get("api/audits/all").then(function(a){return a.data})},findByDates:function(b,c){var d=function(a){return void 0===a||angular.isString(a)?a:a.getYear()+"-"+a.getMonth()+"-"+a.getDay()};return a.get("api/audits/byDates",{params:{fromDate:d(b),toDate:d(c)}}).then(function(a){return a.data})}}}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("configuration",{name:"configuration",parent:"admin",url:"/configuration",data:{roles:["ROLE_ADMIN"],pageTitle:"configuration.title"},views:{"content@":{templateUrl:"scripts/configuration/configurationApp/configuration.html",controller:"ConfigurationController",controllerAs:"cfgCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("configuration"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("ConfigurationController",ConfigurationController),angular.module("mentoringApp").factory("ConfigurationService",["$rootScope","$filter","$http",function(a,b,c){return{get:function(){return c.get("configprops").then(function(a){var c=[];angular.forEach(a.data,function(a){c.push(a)});var d=b("orderBy");return d(c,"prefix")})}}}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("docs",{name:"docs",parent:"admin",url:"/docs",data:{roles:["ROLE_ADMIN"],pageTitle:"global.menu.admin.apidocs"},views:{"content@":{templateUrl:"scripts/configuration/docs/docs.html",controller:"DocsController"}}})}]),angular.module("mentoringApp").controller("DocsController",["$rootScope",function(a){a.activeOption="configuration"}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("health",{name:"health",parent:"admin",url:"/health",data:{roles:["ROLE_ADMIN"],pageTitle:"health.title"},views:{"content@":{templateUrl:"scripts/configuration/health/health.html",controller:"HealthController",controllerAs:"healthCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("health"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("HealthController",HealthController),angular.module("mentoringApp").factory("HealthService",["$http",function(a){return{getMetrics:function(){return a.get("metrics").then(function(a){return a.data})},checkHealth:function(){return a.get("health").then(function(a){return a.data})},threadDump:function(){return a.get("dump").then(function(a){return a.data})}}}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("logs",{name:"logs",parent:"admin",url:"/logs",data:{roles:["ROLE_ADMIN"],pageTitle:"logs.title"},views:{"content@":{templateUrl:"scripts/configuration/logs/logs.html",controller:"LogsController"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("logs"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("LogsController",["$rootScope","$scope","LogsService",function(a,b,c){a.activeOption="configuration",b.loggers=c.findAll(),b.changeLevel=function(a,d){c.changeLevel({name:a,level:d},function(){b.loggers=c.findAll()})}}]),angular.module("mentoringApp").factory("PrintService",["$http",function(a){return{print:function(b){a.post("api/logs",b,{}).success(function(a){return a})}}}]).factory("LogsService",["$resource",function(a){return a("api/logs",{},{findAll:{method:"GET",isArray:!0},changeLevel:{method:"PUT"}})}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("metrics",{parent:"admin",url:"/metrics",data:{roles:["ROLE_ADMIN"],pageTitle:"metrics.title"},views:{"content@":{templateUrl:"scripts/configuration/metrics/metrics.html",controller:"MetricsController",controllerAs:"metricsCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("metrics"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("MetricsController",MetricsController),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("roles",{name:"roles",parent:"site",url:"/roles",data:{roles:["ROLE_ADMIN"]},views:{"content@":{templateUrl:"scripts/configuration/roles/roles.html",controller:"RolesController",controllerAs:"rolCtrl"}},resolve:{mainTranslatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("roles"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("RolesController",RolesController),angular.module("mentoringApp").factory("EmpleadosRL",["$resource",function(a){return a("api/employeeRol/:id",{},Mentoring.resourceHandler)}]).factory("Roles",["$resource",function(a){return a("api/tAuthority/:id",{},Mentoring.resourceHandler)}]).factory("Guardar",["$http",function(a){return{guardar:function(b){return a.post("api/userauth",b,{}).success(function(a){return a})},agrupar:function(a,b){var c={userId:a,authorityName:b};return angular.toJson(c)}}}]).factory("Borrar",["$resource",function(a){return a("api/userauthDelete/:id",{},{query:{method:"GET",isArray:!0},get:{method:"GET",transformResponse:function(a){return a=angular.fromJson(a)}},borrar:{method:"DELETE"}})}]).factory("RolesUsuario",["$resource",function(a){return a("api/userauth/:userId",{},Mentoring.resourceHandler)}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("consult",{name:"consult",parent:"site",url:"/consult",data:{roles:["ROLE_USER"],pageTitle:"consult.title"},views:{"content@":{templateUrl:"scripts/consult/consult.html",controller:"ConsultController",controllerAs:"consultCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("consult"),a.refresh()}]}}).state("consultEvaluation",{name:"consultEvaluation",parent:"site",url:"/consultEvaluation",data:{roles:["ROLE_USER"],pageTitle:"evaluation.title"},views:{"content@":{templateUrl:"scripts/consult/consultEvaluation.html",controller:"ConsultEvaluationController",controllerAs:"consultEvalCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("evaluation"),a.refresh()}]}}).state("consultEvaluationAutoevaluation",{name:"consultEvaluationAutoevaluation",parent:"site",url:"/consultEvaluationAutoevaluation",data:{roles:["ROLE_USER"],pageTitle:"evaluation.autoevaluation.title"},views:{"content@":{templateUrl:"scripts/consult/consultEvaluationAutoevaluation.html",controller:"ConsultEvaluationAutoevaluationController",controllerAs:"consultEvalAutoCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("evaluation"),b.addPart("evaluationAutoevaluation"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("ConsultController",ConsultController),angular.module("mentoringApp").factory("EmpleadosCn",["$resource",function(a){return a("api/employee/:id",{},{query:{method:"GET",isArray:!0},getEmployeeInfo:{isArray:!1},get:{method:"GET",transformResponse:function(a){return a=angular.fromJson(a)}},update:{method:"PUT"}})}]).factory("EmployeesDirector",["$resource",function(a){return a("api/employeesDirector/:directionId",{},Mentoring.resourceHandler)}]).factory("AnswersResource",["$resource",function(a){return a("api/answerss/:id",{},Mentoring.resourceHandler)}]).factory("CompetencesResource",["$resource",function(a){return a("api/competences/:id",{},Mentoring.resourceHandler)}]).factory("EmployeeEvaluableIdResource",["$resource",function(a){return a("api/employeeEvaluable/:id",{},Mentoring.resourceHandler)}]).factory("EmployeeLeaderResource",["$resource",function(a){return a("api/employeeLeader/",{},Mentoring.resourceHandler)}]).factory("EmployeeIsLeaderResource",["$resource",function(a){return a("api/isleader/:employeeId",{},Mentoring.resourceHandlerGETNoTransform)}]).factory("EmployeeEvaluationResource",["$resource",function(a){return a("api/evaluation/:employeeId",{},{query:{method:"GET",isArray:!0},getEvaluation:{url:"api/evaluation/:employeeId/:evaluationId",isArray:!1},get:{method:"GET",transformResponse:function(a){return a=angular.fromJson(a)}},update:{method:"PUT"}})}]).factory("EvaluationEmployeeLeaderResource",["$resource",function(a){return a("api/evaluationEmpLea/:employeeId/:leaderId",{},Mentoring.resourceHandler)}]).factory("PillarsResource",["$resource",function(a){return a("api/pillars/:id",{},Mentoring.resourceHandler)}]).factory("QuestionsResource",["$resource",function(a){return a("api/questionss/:id",{},{query:{method:"GET",isArray:!0},get:{method:"GET",transformResponse:function(a){return a=angular.fromJson(a)}},update:{method:"PUT"}})}]).factory("StatesResource",["$resource",function(a){return a("api/statess/:id",{},Mentoring.resourceHandler)}]).factory("EvaluationsAllEmployees",["$resource",function(a){return a("api/allEvaluations/:employeeId/",{},Mentoring.resourceHandler)}]).factory("EvaluationsCn",["$resource",function(a){return a("api/autoevaluation/:employeeId/:leaderId",{},Mentoring.resourceHandler)}]).factory("EvaluationsMandoCn",["$resource",function(a){return a("api/evaluationLeader/:leaderId",{},Mentoring.resourceHandler)}]).factory("EvaluationsConsultLeader",["$resource",function(a){return a("api/allocationLeaderDate/:leaderId",{},Mentoring.resourceHandler)}]).factory("EmployeesDIRECTOR",["$resource",function(a){return a("api/employeesDirector/:directionId",{},Mentoring.resourceHandler)}]).factory("LeadersDIRECTOR",["$resource",function(a){return a("api/leadersDirector/:directionId",{},Mentoring.resourceHandler)}]).factory("EmployeesGERENTE",["$resource",function(a){
return a("api/employeesGerente/:managerId",{},Mentoring.resourceHandler)}]).factory("LeadersGERENTE",["$resource",function(a){return a("api/leadersGerente/:managerId",{},Mentoring.resourceHandler)}]).factory("EmployeesRRHH",["$resource",function(a){return a("api/employeesRrhh/:id",{},Mentoring.resourceHandler)}]).factory("LeadersRRHH",["$resource",function(a){return a("api/leadersRrhh/:id",{},Mentoring.resourceHandler)}]).factory("IsModificableService",function(){return{modificable:function(a,b,c,d,e,f,g,h){if(a.employeeId===b.employeeId){var i=new Date(b.creationDate);return d&&"auto"===b.evaluationType&&c===i.getFullYear()?!0:e||"final"===b.evaluationType?!1:!1}if(h||g||f)return!0;var j=new Date(b.creationDate),k=j.getFullYear();return k!==c?!1:d&&"auto"==b.evaluationType?b.employeeId==a.employeeId:e&&"final"==b.evaluationType?a.employeeId==b.leaderId:"eval"!=b.evaluationType||e?!1:a.employeeId==b.leaderId}}}),angular.module("mentoringApp").controller("ConsultEvaluationController",ConsultEvaluationController),angular.module("mentoringApp").factory("EmpleadosAE",["$resource",function(a){return a("api/allocationLeaderDate/:leaderId",{},Mentoring.resourceHandler)}]).factory("SharingEvaluationService",function(){return{setId:function(a){this.id=a},getId:function(){return this.id},setModification:function(a){this.esModificable=a},getModification:function(){return this.esModificable},setEvaluado:function(a){this.evaluado=a},getEvaluado:function(){return this.evaluado}}}),angular.module("mentoringApp").controller("ConsultEvaluationAutoevaluationController",ConsultEvaluationAutoevaluationController),angular.module("mentoringApp").factory("ConsultEvaluationAutoevaluationService",["$resource",function(a){return a("api/consultEvaluationAutoevaluation/:employeeId/:year",{},Mentoring.resourceHandler)}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("error",{parent:"site",url:"/error",data:{roles:[],pageTitle:"errors.title"},views:{"content@":{templateUrl:"scripts/error/error.html"},"header@":{templateUrl:"scripts/components/header/header.html"}},resolve:{mainTranslatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("error"),a.refresh()}]}}).state("unauthorized",{parent:"site",url:"/unauthorized",data:{roles:[],pageTitle:"errors.title"},views:{"content@":{templateUrl:"scripts/error/unauthorized.html"},"header@":{templateUrl:"scripts/components/header/header.html",controller:"HeaderController"}},resolve:{mainTranslatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("error"),a.refresh()}]}}).state("notfound",{parent:"site",url:"/notfound",data:{roles:[],pageTitle:"errors.title"},views:{"content@":{templateUrl:"scripts/error/notfound.html"},"header@":{templateUrl:"scripts/components/header/header.html",controller:"HeaderController"}},resolve:{mainTranslatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("error"),a.refresh()}]}}).state("accessdenied",{parent:"site",url:"/accessdenied",data:{roles:[]},views:{"content@":{templateUrl:"scripts/error/accessdenied.html"},"header@":{templateUrl:"scripts/components/header/header.html",controller:"HeaderController"}},resolve:{mainTranslatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("error"),a.refresh()}]}})}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("evaluation",{name:"evaluation",parent:"site",url:"/evaluation",data:{roles:["ROLE_USER"],pageTitle:"evaluation.title"},views:{"content@":{templateUrl:"scripts/evaluation/evaluation.html",controller:"EvaluationController",controllerAs:"evaluationCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("evaluation"),a.refresh()}]}}).state("evaluationleader",{name:"evaluationleader",parent:"site",url:"/evaluationleader",data:{roles:["ROLE_USER"],pageTitle:"evaluationLeader.title"},views:{"content@":{templateUrl:"scripts/evaluation/evaluationleader.html",controller:"EvaluationleaderController",controllerAs:"evalLeaderCtrl"},"header@":{templateUrl:"scripts/components/header/header.html",controller:"HeaderController"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("evaluationLeader"),a.refresh()}]}}).state("consultEvaluationByLeader",{name:"consultEvaluationByLeader",parent:"site",url:"/consultEvaluationByLeader",data:{roles:["ROLE_ADMIN","ROLE_RRHH","ROLE_DIRECTOR","ROLE_DIRECTORG"],pageTitle:"leadersEvaluation.title"},views:{"content@":{templateUrl:"scripts/evaluation/leadersEvaluations.html",controller:"LeadersEvaluationsController",controllerAs:"leadersEvalCtrl"},"header@":{templateUrl:"scripts/components/header/header.html",controller:"HeaderController"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("leaderEvaluations"),a.refresh()}]}}).state("consultEvaluationByEmployee",{name:"consultEvaluationByEmployee",parent:"site",url:"/consultEvaluationByEmployee",data:{roles:["ROLE_ADMIN","ROLE_RRHH","ROLE_DIRECTOR","ROLE_DIRECTORG"],pageTitle:"leadersEvaluation.title"},views:{"content@":{templateUrl:"scripts/evaluation/employeesEvaluation.html",controller:"EmployeesEvaluationsController",controllerAs:"employeesEvalCtrl"},"header@":{templateUrl:"scripts/components/header/header.html",controller:"HeaderController"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("employeesEvaluation"),a.refresh()}]}}).state("consultEvaluationAll",{name:"consultEvaluationAll",parent:"site",url:"/consultEvaluationAll",data:{roles:["ROLE_ADMIN","ROLE_RRHH","ROLE_DIRECTORG"],pageTitle:"evaluationAll.title"},views:{"content@":{templateUrl:"scripts/evaluation/allEvaluations.html",controller:"AllEvaluationsController",controllerAs:"allEvaluationsCtrl"},"header@":{templateUrl:"scripts/components/header/header.html",controller:"HeaderController"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("evaluationAll"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("EvaluationController",EvaluationController),angular.module("mentoringApp").factory("CalculateEvaluationResult",["$resource",function(a){return a("api/calculateEvaluationResult/:employeeId/:evaluationId/:year",{},{get:{method:"GET"}})}]).factory("EmpleadosAE",["$resource",function(a){return a("api/allocationLeaderDate/:leaderId",{},Mentoring.resourceHandler)}]).factory("EmpleadosEvaluables",["$resource",function(a){return a("api/employeeEvaluable",{},Mentoring.resourceHandler)}]).factory("LastEvaluationAssigned",["$resource",function(a){return a("api/lastEvalAssigned/:employeeId/:leaderId",{},{get:{method:"GET"}})}]).factory("LastEvaluationAssignedWithEvalType",["$resource",function(a){return a("api/lastEvalAssignedWithEvalType/:employeeId/:leaderId/:evaluationType",{},{get:{method:"GET"}})}]).factory("AnswersSelect",["$resource",function(a){return a("api/answersSelect/:id",{},Mentoring.resourceHandler)}]).factory("EvaluationId",["$resource",function(a){return a("api/evaluationId/:id",{},Mentoring.resourceHandler)}]).factory("isEvaluationDate",["$resource",function(a){return a("api/isEvaluationDate",{},Mentoring.resourceHandlerGET)}]).factory("EvaluationYear",["$resource",function(a){return a("api/evaluationYear",{},Mentoring.resourceHandlerGET)}]).factory("isFinalEvaluationDate",["$resource",function(a){return a("api/isFinalEvaluationDate",{},Mentoring.resourceHandlerGET)}]).factory("getFinalEvaluationDate",["$resource",function(a){return a("api/isEvaluationDate",{},{getDateFinalEvaluationFrom:{url:"api/evaluationFinalDateFrom",method:"get"},getDateFinalEvaluationTo:{url:"api/evaluationFinalDateTo",method:"get"},isFinalEvaluationDate:{url:"api/isFinalEvaluationDate",method:"get"}})}]).factory("GetLastAutoEvalByEmployeeId",["$resource",function(a){return a("api/getLastAutoEvalByEmployeeId/:employeeId",{},Mentoring.resourceHandler)}]).factory("AnswersEval",["$http",function(a){return{guardar:function(b){return a.post("api/answerss",b,{}).success(function(a){return a})},guardar2:function(b){return a.post("api/evaluation",b,{}).success(function(a){return a})},guardar3:function(b){return a.post("api/answersSelect",b,{}).success(function(a){return a})},agrupar:function(a,b){var c={id:b,respuestas:[]};for(var d in a)if("undefined"!=typeof a[d]){var e={questionId:d,statesId:a[d]};c.respuestas.push(e)}return c},agrupar2:function(a,b,c,d,e,f,g,h){d=d||"",e=e||"";var i=new Date,j=i.getFullYear(),k=null;k=g?"Final-"+c.toString()+"-"+b.toString()+"-"+j.toString():"Eval-"+c.toString()+"-"+b.toString()+"-"+j.toString();var l=k,m=c,n=b,o=b,p={answerId:l,employeeId:m,leaderId:n,userAdd:o,observaciones:d,observacionesEvaluador:e,evaluationType:f};return Mentoring.isUndefinedOrNull(h)||(p.id=h),p},agrupar3:function(a,b,c,d){var e=0,f=[];d&&(e=1);for(var g in c){var h={id:{id:a,selectNum:b},questionCode:c[g]};b++,f.push(h)}return f}}}]).factory("SharingEvaluationService",function(){this.id=null,this.esModifiable=null,this.evaluado=null;var a=function(){return this.id},b=function(a){this.id=a};return{setId:b,getId:a,setModification:function(a){this.esModificable=a},getModification:function(){return this.esModificable},getEvaluado:function(){return this.evaluado},setEvaluado:function(a){this.evaluado=a}}}),angular.module("mentoringApp").controller("EvaluationleaderController",EvaluationleaderController),angular.module("mentoringApp").factory("AnswersResourceEL",["$http",function(a){return{guardar:function(b){return a.post("api/answerss",b,{}).success(function(a){return a})},guardar2:function(b){return a.post("api/evaluation",b,{}).success(function(a){return a})},agrupar:function(a,b){var c=new Date,d=c.getFullYear(),e="Eval-"+b.toString()+"-"+d.toString(),f=e,g={id:f,respuestas:[]};for(var h in a)if("undefined"!=typeof a[h]){var i={questionId:h,statesId:a[h]};g.respuestas.push(i)}return angular.toJson(g)},agrupar2:function(a,b,c,d){c=c||"";var e=new Date,f=e.getFullYear(),g="Eval-"+b.toString()+"-"+f.toString(),h=g,i=b,j=d.employeeId,k=b,l={answerId:h,employeeId:i,leaderId:j,userAdd:k,observaciones:c};return angular.toJson(l)}}}]),angular.module("mentoringApp").controller("LeadersEvaluationsController",LeadersEvaluationsController),angular.module("mentoringApp").factory("LeadersEvaluationsService",["$resource",function(a){return a("api/leadersEvaluation/:leaderId/:year",{},{getLeadersEvaluations:{method:"GET",isArray:!0}})}]),angular.module("mentoringApp").controller("EmployeesEvaluationsController",EmployeesEvaluationsController),angular.module("mentoringApp").factory("EmployeesEvaluationService",["$resource",function(a){return a("api/employeesEvaluation/:areaId/:year",{},{get:{method:"GET",isArray:!0},getAllEvaluations:{url:"api/employeesEvaluationAll/:year",method:"GET",isArray:!0}})}]),angular.module("mentoringApp").controller("AllEvaluationsController",AllEvaluationsController),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("home",{parent:"site",url:"/home",data:{roles:["ROLE_USER"]},views:{"content@":{templateUrl:"scripts/home/home.html",controller:"HomeController"}},resolve:{mainTranslatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("home"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("HomeController",["$rootScope",function(a){a.activeOption=""}]),angular.module("mentoringApp").controller("MainController",MainController),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("individualMatrix",{name:"individualMatrix",parent:"site",url:"/individual",data:{roles:["ROLE_ADMIN","ROLE_RRHH","ROLE_DIRECTORG"],pageTitle:"increments.title"},views:{"content@":{templateUrl:"scripts/increments/individual.html",controller:"IndividualController",controllerAs:"IndividualCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("increments/individual"),a.refresh()}]}}).state("multipleMatrix",{name:"multipleMatrix",parent:"site",url:"/multiple",data:{roles:["ROLE_ADMIN","ROLE_RRHH","ROLE_DIRECTORG"]},views:{"content@":{templateUrl:"scripts/increments/multiple.html",controller:"MultipleController",controllerAs:"MultipleCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("increments/multiple"),a.refresh()}]}}).state("tableIncrements",{name:"incrementsTable",parent:"site",url:"/tables",data:{roles:["ROLE_ADMIN","ROLE_RRHH","ROLE_DIRECTORG"]},views:{"content@":{templateUrl:"scripts/increments/incrementsTable.html",controller:"IncrementsController",controllerAs:"IncrementsCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("increments/increments"),a.refresh()}]}}).state("wageLimits",{name:"wageLimits",parent:"site",url:"/limits",data:{roles:["ROLE_ADMIN","ROLE_RRHH","ROLE_DIRECTORG"]},views:{"content@":{templateUrl:"scripts/increments/limits.html",controller:"WageLimitsController",controllerAs:"WageLimitsCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("increments/limits"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("IndividualController",IndividualController),angular.module("mentoringApp").factory("Employees",["$resource",function(a){return a("api/employee",{},Mentoring.resourceHandlerGET)}]).factory("EmployeesCategory",["$resource",function(a){return a("api/employeeCatId/:employeeId",{},Mentoring.resourceHandlerGET)}]).factory("Retribution",["$resource",function(a){return a("api/retributions",{},{get:{method:"GET",url:"api/retributions/:retributionId",params:{},isArray:!1},getEmployeeInfo:{method:"GET",url:"api/retributions/employeeInfo/:employeeId/:categoryId/:year",isArray:!1}})}]),angular.module("mentoringApp").controller("MultipleController",MultipleController),angular.module("mentoringApp").factory("EmployeesCategoryByYear",["$resource",function(a){return a("api/employeeCatYear/:dateFrom",{},Mentoring.resourceHandlerGET)}]).factory("Directions",["$resource",function(a){return a("api/directions",{},{query:{method:"GET",isArray:!0}})}]).factory("EmployeeMultiple",["$resource",function(a){return a("api/employeeCatYear",{},{getMultipleData:{method:"POST",isArray:!0},saveConfirmedData:{url:"api/employeeCatYear/confirmed/:directionId",method:"POST"},saveIncreases:{url:"api/employeeCatYear/increases",method:"POST"}})}]).factory("Areas",["$resource",function(a){return a("api/area",{},{query:{method:"GET",isArray:!0},getArea:{url:"api/area/:areaId"},getDirectionAreas:{url:"api/area/direction/:directionId",isArray:!0}})}]),angular.module("mentoringApp").controller("IncrementsController",IncrementsController),angular.module("mentoringApp").factory("PositionIncreases",["$resource",function(a){return a("api/positionIncreases/",{},{getYears:{url:"api/positionIncreases/years",method:"GET",isArray:!0},query:{url:"api/positionIncreases/:year/:direction",method:"GET",isArray:!1},savePositions:{url:"api/positionIncreases/:direction",method:"POST"}})}]).factory("WageBandService",["$resource",function(a){return a("api/wageBand",{},{query:{method:"GET",isArray:!0}})}]).factory("WageBandPositionService",["$resource",function(a){return a("api/wageBandPositions",{},{query:{method:"GET",isArray:!0}})}]).factory("EvaluationMarkService",["$resource",function(a){return a("api/evaluationMarks",{},{query:{method:"GET",isArray:!0}})}]),angular.module("mentoringApp").controller("WageLimitsController",WageLimitsController),angular.module("mentoringApp").factory("WageBandLimitsService",["$resource",function(a){return a("api/wageBandLimits/",{},{query:{url:"api/wageBandLimits/:year/:direction",method:"GET",isArray:!1},saveLimits:{method:"POST"}})}]).factory("DirectionsService",["$resource",function(a){return a("api/directions",{},Mentoring.resourceHandlerGET)}]),angular.module("mentoringApp").config(["$stateProvider",function(a){a.state("manualCompetencias",{name:"manualCompetencias",parent:"site",url:"/manualCompetencias",data:{},views:{"content@":{templateUrl:"scripts/information/manualCompetencias.html",controller:"InformationController",controllerAs:"InformationCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("information/competences"),a.refresh()}]}}).state("mapasCarrera",{name:"mapasCarrera",parent:"site",url:"/mapasCarrera",data:{},views:{"content@":{templateUrl:"scripts/information/mapasCarrera.html",controller:"InformationController",controllerAs:"InformationCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("information/maps"),a.refresh()}]}}).state("modeloCT",{name:"modeloCT",parent:"site",url:"/modeloCT/:employeeId/:leaderId",data:{},views:{"content@":{templateUrl:"scripts/information/CTModel/modeloCt.html",controller:"CTModelController",controllerAs:"CTModelCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("information/ctModel"),a.refresh()}]}}).state("assignCompetences",{name:"assignCompetences",parent:"site",url:"/assignCompetences",data:{roles:["ROLE_USER"],pageTitle:"evaluation.autoevaluation.title"},views:{"content@":{templateUrl:"scripts/information/competences/assignCompetenceValues.html",controller:"AssignCompetencesController",controllerAs:"assignCompetencesCtrl"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function(a,b){return b.addPart("evaluation"),b.addPart("positions"),b.addPart("assignCompetences"),a.refresh()}]}})}]),angular.module("mentoringApp").controller("InformationController",InformationController),angular.module("mentoringApp").controller("CTModelController",CTModelController),angular.module("mentoringApp").factory("CTModelService",["$resource",function(a){return a("api/CTResults",{},{getQuestions:{url:"api/CTResults/questions",method:"GET",isArray:!0},getByEmployeeId:{url:"api/CTResults/:employeeId",method:"GET",isArray:!0},getLeaderEvaluations:{url:"api/CTResults/leader/:leaderId",method:"GET",isArray:!0},saveCTResult:{method:"POST"},getCTAnswers:{url:"api/CTAnswers/:employeeId/:answersId",method:"GET",isArray:!0},obtainResult:{url:"api/CTResults/calculate",method:"POST"}})}]),angular.module("mentoringApp").controller("AssignCompetencesController",AssignCompetencesValues),angular.module("mentoringApp").filter("customCompetencesFilter",CustomCompetencesFilter),angular.module("mentoringApp").factory("PositionService",["$resource",function(a){return a("api/positions",{},{query:{method:"GET",isArray:!0}})}]).factory("WeightQuestionService",["$resource",function(a){return a("api/weightQuestions",{},{getByPositionId:{url:"api/weightQuestions/:positionId",isArray:!0},saveWeightQuestions:{method:"POST"}})}]);