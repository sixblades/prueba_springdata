{"version":3,"sources":["../../../app/scripts/evaluation/evaluation.controller.refactor.js"],"names":[],"mappings":"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","file":"evaluation.controller.refactor.js","sourcesContent":["/* jshint -W097 */\n/* globals angular, $, Mentoring*/\n'use strict';\n/*@ngInject*/\nfunction EvaluationController($rootScope, $sce, $state, Principal, $translate, QuestionsResource, LastEvaluationAssigned, \n    GetLastAutoEvalByEmployeeId, LastEvaluationAssignedWithEvalType, StatesResource, AnswersSelect, AnswersEval, \n    EmpleadosEvaluables, EvaluationEmployeeLeaderResource, AnswersResource, EmpleadosAE, EmployeeEvaluationResource, \n    CompetencesResource, PillarsResource, isEvaluationDate, isFinalEvaluationDate, EmployeeIsLeaderResource, \n    EmployeesRRHH, PrintService) {\n\n\tvar vm = this;\n\t\n\tvar idToModify; //en caso de que en el alta se cargue una evaluacion existente, se almacenara su id por si se quiere modificar.\n\n\t// Comprobamos si el estado es diferente al login\n\tif ($state.current.name != 'login') {\n\t\tPrincipal.identity().then(function (account) {\n\t\t\t// Activamos la opción de menú Alta de Evaluación\n\t\t\t$rootScope.activeOption = \"evaluation\";\n\t\t\t// Recuperamos la información del usuario\n\t\t\tvm.account = account;\n\t\t\t// Asignamos los permisos del usuario a partir de su role.\n\t\t\tif (!Mentoring.isUndefinedOrNull(account) && !Mentoring.isUndefinedOrNull(account.roles) && !Mentoring.isUndefinedOrNull(account.isLeader)) {\n\t\t\t\tvm.isLeader = account.isLeader;\n\t\t\t\tvm.employeeId = account.employeeId;\n\t\t\t\t//permite al usuario dar de alta una evaluacion\n\t\t\t\tvm.evaluableByUser = (account.isLeader == 1 || account.roles.indexOf('ROLE_RRHH') > -1) ? true : false;\n\t\t\t\tvm.user = {\n                    firstName: account.firstName,\n                    lastName: account.lastName\n                };\n\t\t\t\tvm.roleDIRECTOR = account.roles.indexOf('ROLE_DIRECTOR') > -1;\n\t\t\t\tvm.roleDIRECTORG = account.roles.indexOf('ROLE_DIRECTORG') > -1;\n\t\t\t\tvm.roleGERENTE = account.roles.indexOf('ROLE_GERENTE') > -1;\n\t\t\t\tvm.roleADMIN = account.roles.indexOf('ROLE_ADMIN') > -1;\n\t\t\t\tvm.roleRRHH = account.roles.indexOf('ROLE_RRHH') > -1;\n\t\t\t\tvm.isEvaluation = false;\n                \n\t\t\t\t//El usuario puede autoevaluarse en funcion de su rol\n\t\t\t\tvm.isAutoEvaluation = (vm.roleDIRECTOR || vm.roleGERENTE || vm.roleDIRECTORG) ? false : true;\n\t\t\t\tvm.destacados = [];\n\t\t\t\tvm.mejorar = [];\n\t\t\t\tvm.listSelect = [];\n\n\t\t\t\t// Chart.js Data\n\t\t\t\tvm.data = {\n\t\t\t\t\tlabels: ['Gestión: Talent', 'Gestión: Attitude', 'Gestión: Business', 'Mando: Talent Attitude', 'Mando: Business', 'VASS'],\n\t\t\t\t\tdatasets: [{\n\t\t\t\t\t\tlabel: 'Evaluación', fillColor: 'rgba(151,187,205,0.2)', strokeColor: 'rgba(151,187,205,1)',\n\t\t\t\t\t\tpointColor: 'rgba(151,187,205,1)', pointStrokeColor: '#fff',\n\t\t\t\t\t\tpointHighlightFill: '#fff', pointHighlightStroke: 'rgba(220,220,220,1)',\n\t\t\t\t\t\tdata: [70, 88, 87, 70, 75, 85]\n\t\t\t\t\t}]\n\t\t\t\t};\n\n\t\t\t\t// Chart.js Options\n\t\t\t\tvm.options = {\n\t\t\t\t\tresponsive: true, scaleShowLine: true, angleShowLineOut: true, scaleShowLabels: false,\n\t\t\t\t\tscaleBeginAtZero: true, angleLineColor: 'rgba(0,0,0,.1)',\n\t\t\t\t\tangleLineWidth: 1, pointLabelFontFamily: '\"Arial\"',\n\t\t\t\t\tpointLabelFontStyle: 'normal', pointLabelFontSize: 10, pointLabelFontColor: '#666', pointDot: true,\n\t\t\t\t\tpointDotRadius: 3, pointDotStrokeWidth: 1, pointHitDetectionRadius: 20,\n\t\t\t\t\tdatasetStroke: true, datasetStrokeWidth: 2, datasetFill: true,\n\t\t\t\t\tlegendTemplate: '<ul class=\"tc-chart-js-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span style=\"background-color:<%=datasets[i].strokeColor%>\"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'\n\t\t\t\t};\n\n\t\t\t\t//Recuperamos si estamos o no en periodo de evaluacion\n\t\t\t\tisEvaluationDate.get((isDate) => {\n\t\t\t\t\tvm.isEvaluationDate = isDate.value;\n\t\t\t\t});\n                //Recuperamos si estamos en evaluacion final o no\n                isFinalEvaluationDate.get((isDate) => {\n                    vm.isFinalEvaluationDate = isDate.value;\n                    populateAndShowEvaluations();\n                });\n\n\t\t\t\tvar populateAndShowEvaluations = () => {\n                    let classStr = 'panel panel-info evaluacion_forms';\n\t\t\t\t\tif (account.isLeader == 1 || vm.roleRRHH) {\n\t\t\t\t\t\tvm.empleado = [];\n\t\t\t\t\t\tif (!(vm.roleDIRECTORG || vm.roleADMIN)) {\n\t\t\t\t\t\t\tEmpleadosAE.query({leaderId: vm.employeeId}, (result) => {\n\t\t\t\t\t\t\t\tvm.evaluables = result;\n\t\t\t\t\t\t\t\tif (vm.isEvaluationDate) {\n\t\t\t\t\t\t\t\t\tvm.classEval = classStr;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (vm.roleDIRECTORG || vm.roleADMIN) {\n\t\t\t\t\t\t\tEmpleadosEvaluables.query({leaderId: vm.employeeId}, (result) => {\n\t\t\t\t\t\t\t\tvm.evaluables = result;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (vm.roleRRHH) {\n\t\t\t\t\t\t\tEmployeesRRHH.query((result) => {\n\t\t\t\t\t\t\t\tvm.evaluables = result;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (vm.isEvaluationDate) {\n\t\t\t\t\t\t\tvm.classEval = classStr;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvm.classEval = classStr;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n                    \n                    vm.isFinalEvaluation = vm.isFinalEvaluationDate;\n                    vm.classEval = vm.isFinalEvaluation ? classStr + ' final' : classStr;\n\n\t\t\t\t\t// Consultamos los valores para cargar las preguntas y respuestas\n\t\t\t\t\tvm.questions = []; vm.states = []; vm.empleado = []; vm.competence = []; vm.pillar = [];\n\t\t\t\t\tvm.evaluable = []; vm.destacados = []; vm.mejorar = []; vm.selected = []; vm.respuesta = [];\n\t\t\t\t\tvm.msgModal = 'incorrecto';\n\n\t\t\t\t\tvm.loadAll();\n\n\t\t\t\t\t/** vm.selected = [];\n\t\t\t\t\tvm.respuesta = []; */\n\n\t\t\t\t\t// En periodo de autoevaluacion renderizamos la ultima, si la hay\n\t\t\t\t\tif (vm.isEvaluationDate) {\n\t\t\t\t\t\tgetAndRenderLastEvaluation(vm.employeeId, vm.employeeId, 'auto');\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tGetLastAutoEvalByEmployeeId.query({employeeId: vm.employeeId}, (result) => {\n                        if (result.length > 0) {\n                            idToModify = result[0].id;\n                            vm.observaciones = result[0].observations;\n                            let codigoResp = result[0].id;\n                            if (codigoResp != undefined) {\n                                AnswersResource.query({id: codigoResp}, answersResourceCb);\n                                AnswersSelect.query({id: codigoResp}, (res) => {\n                                    for(var i=0,len=result.length; i<len; i++) {\n                                        if(i<3) {\n                                            vm.destacados[i] = result[i].questionCode;\n                                        } else {\n                                            vm.mejorar[i] = result[i].questionCode;\n                                        }\n                                    }\n                                });\n                            }\n                        }\n\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t// Comprobamos si el usuario está autenticado.\n\t\t\t\t\tif ($state.current.name != 'login') {\n\t\t\t\t\t\tvm.isAuthenticated = Principal.isAuthenticated();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t}\n\t\n\t/* Muestra o no el formulario de auto evaluacion */\n\tvm.showEvaluationForm = function() {\n\t\treturn vm.roleDIRECTORG || vm.roleADMIN || vm.roleRRHH || vm.isLeader || vm.isEvaluationDate;\n\t};\n\t\n\tvm.getQuestionCode = function (questionCode) {\n\t\tvm.codePregunta = questionCode;\n\t\tvm.definicionInfo = $sce.trustAsHtml($translate.instant('evaluation.info.' + questionCode + '.comportamientoInfo'));\n\t};\n\n\t// Función para cargar los valores del controlador\n\tvm.loadAll = () => {\n\t\tif (Mentoring.isUndefinedOrNull(vm.evaluable.info)) {\n\t\t\tif (vm.isLeader === 0) {\n\t\t\t\tQuestionsResource.query({leader: 0}, (result) => {\n\t\t\t\t\tvm.questionss = result;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tQuestionsResource.query((result) => {\n\t\t\t\t\tvm.questionss = result;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tCompetencesResource.query((result) => {\n\t\t\tlet aux = [];\n\t\t\tlet j = 0;\n\t\t\tif (vm.isLeader === 0) {\n\t\t\t\tfor (let aa in result) {\n\t\t\t\t\tif (result[aa].competenceCode != 'mando') {\n\t\t\t\t\t\taux[j] = result[aa];\n\t\t\t\t\t\tj++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvm.competences = aux;\n\t\t\t} else {\n\t\t\t\tvm.competences = result;\n\t\t\t}\n\t\t});\n        loadPillarsAndStates();\n\t};\n    \n\tvm.select = function (index, idPregunta) {\n\t\tvm.selected[idPregunta] = index;\n\t};\n\n\tvm.change = function () {\n\t\tidToModify = null;\n\t\tvm.observaciones = '';\n\t\tvm.selected = [];\n\t\tvm.respuesta = [];\n\t\tvm.destacados = [];\n\t\tvm.mejorar = [];\n\t\t\t\n\t\t// Comprobamos que hay seleccionado uno (evaluamos a alguien)\n\t\tif (!Mentoring.isUndefinedOrNull(vm.evaluable.info)) {\n\t\t\t// Pondremos las preguntas en funcion de si el evaluado es o no lider\n\t\t\tEmployeeIsLeaderResource\n                .get({employeeId: (vm.evaluable.info.employeeId || vm.evaluable.info.id)}, (isLeaderResult) => {\n                    buildQuestions4Evaluation(parseInt(isLeaderResult[0]));\n                    // Solo recuperamos en caso de autoevaluaciones o evaluaciones finales\n                    if (vm.isFinalEvaluationDate || vm.isEvaluationDate) {\n                        var employeeId = (vm.evaluable.info.employeeId || vm.evaluable.info.id);\n                        getAndRenderLastEvaluation(employeeId, vm.employeeId, getEvaluationType());\n                    }\n\t\t\t});\n\t\t}\n\t};\n\n\tfunction getEvaluationType() {\n\t\tvar result = 'eval';\n        \n\t\tif (vm.isFinalEvaluationDate) {\n\t\t\tresult = 'final';\n\t\t} else if (vm.isEvaluationDate) {\n\t\t\tresult = 'auto';\n\t\t}\n\t\treturn result;\n\t}\n\n\t// creo que no esta bien, hace consulta de las evaluaciones (empleado, lider) y renderiza la primera posicion del resultado\n\tfunction heredado(employeeIdVal, leaderIdVal) {\n\t\tEvaluationEmployeeLeaderResource.query({employeeId: employeeIdVal, leaderId: leaderIdVal}, \n            (result) => {\n                if (result.length > 0) {\n                    idToModify = result[0].id;\n                    var codigoResp = result[0].id;\n                    var observaciones = result[0].observations;\n                    vm.observaciones = observaciones;\n                    if (!Mentoring.isUndefinedOrNull(codigoResp)) {\n                        getAnswersCodigo(codigoResp, true);\n                    }\n                }\n\t\t});\n\t}\n\n\tfunction getAndRenderAllEvaluationByEmployee(employeeId) {\n\t\tEmployeeEvaluationResource.query({employeeId: employeeId}, obtainEvaluationEmployeeCb);\n\t}\n\n\tfunction isDirectorOrDirectorGOrAdminIrRRHHRol() {\n\t\treturn (vm.roleDIRECTOR || vm.roleDIRECTORG || vm.roleADMIN || vm.roleRRHH);\n\t}\n\n\tfunction getAndRenderLastEvaluation(employeeIdVal, leaderIdVal, evaluationTypeVal) {\n\t\tLastEvaluationAssignedWithEvalType.get({\n\t\t\temployeeId: employeeIdVal, \n            leaderId: leaderIdVal, \n            evaluationType: evaluationTypeVal\n\t\t}, lastEvaluationCb);\n\t}\n\n\tfunction buildQuestions4Evaluation(isLeaderResult) {\n\t\tvm.loadAll = function () {\n\t\t\tif (isLeaderResult === 0) {\n\t\t\t\tQuestionsResource.query({leader: 0}, (result) => {\n\t\t\t\t\tvm.questionss = result;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tQuestionsResource.query((result) => {\n\t\t\t\t\tvm.questionss = result;\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tCompetencesResource.query((result) => {\n\t\t\tlet aux = [];\n\t\t\tlet j = 0;\n\t\t\tif (isLeaderResult === 0) {\n\t\t\t\tfor (let aa in result) {\n\t\t\t\t\tif (result[aa].competenceCode != 'mando') {\n\t\t\t\t\t\taux[j] = result[aa];\n\t\t\t\t\t\tj++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvm.competences = aux;\n\t\t\t} else {\n\t\t\t\tvm.competences = result;\n\t\t\t}\n\t\t});\n\t\tloadPillarsAndStates();\n\t\tvm.loadAll();\n\t}\n\n\t/** Función que se lanza al realizar un cambio en alguno de los selectores. */\n\tvm.changeoLD = function (dato) {\n\t\tidToModify = undefined;\n        vm.observaciones = '';\n        vm.selected = [];\n        vm.respuesta = [];\n        vm.observaciones = '';\n        vm.destacados = [];\n        vm.mejorar = [];\n        \n\t\tif (!(vm.roleDIRECTOR || vm.roleDIRECTORG || vm.roleADMIN || vm.roleRRHH)) {\n\t\t\tif (Mentoring.insUndefinedOrNull(vm.evaluable.info)) {\n\t\t\t\tvm.isAutoEvaluation = vm.isEvaluation ? true : false;\n\t\t\t\tEmployeeEvaluationResource.query({employeeId: vm.employeeId}, obtainEvaluationEmployeeCb);\n\n\t\t\t} else {\n\t\t\t\tvm.isEvaluation = true;\n\t\t\t\tEmployeeIsLeaderResource.get({employeeId: vm.evaluable.info.employeeId}, obtainEmployeeLeaderCb);\n\n\t\t\t\tLastEvaluationAssigned.get({\n\t\t\t\t\temployeeId: vm.evaluable.info.employeeId, leaderId: vm.employeeId\n\t\t\t\t}, lastEvaluationCb);\n\n\t\t\t}\n\t\t} else {\n\n\t\t\tif (Mentoring.insUndefinedOrNull(vm.evaluable.info)) {\n\t\t\t\tvm.isAutoEvaluation = vm.isEvaluation ? true : false;\n\t\t\t\tEmployeeEvaluationResource.query({employeeId: vm.employeeId}, obtainEvaluationEmployeeCb);\n\n\t\t\t} else {\n\t\t\t\tvm.isEvaluation = true;\n\t\t\t\tEmployeeIsLeaderResource.get({employeeId: vm.evaluable.info.id}, obtainEmployeeLeaderCb);\n\t\t\t\tEvaluationEmployeeLeaderResource.query(\n                    {employeeId: vm.evaluable.info.id, \n                    leaderId: vm.employeeId\n\t\t\t\t}, obtainEvaluationEmployeeCb);\n\t\t\t}\n\t\t}\n\t};\n    \n    var lastEvaluationCb = (lastEvaluation) => {\n        if (!Mentoring.isUndefinedOrNull(lastEvaluation)) {\n            idToModify = lastEvaluation.id;\n            var codigoResp = lastEvaluation.id;\n            vm.observaciones = lastEvaluation.observations;\n            if (!Mentoring.isUndefinedOrNull(codigoResp)) {\n                getAnswersCodigo(codigoResp, true);\n            }\n        }\n    };\n    var obtainEvaluationEmployeeCb = (result) => {\n        if (result.length > 0) {\n            idToModify = result[0].id;\n            var codigoResp = result[0].id;\n            vm.observaciones = result[0].observations;\n            if (!Mentoring.isUndefinedOrNull(codigoResp)) {\n                getAnswersCodigo(codigoResp, true);\n            }\n        }\n    };\n    var obtainEmployeeLeaderCb = (result2) => {\n\t\tvm.evaluadoLider = parseInt(result2[0]);\n        vm.loadAll = function () {\n            if (vm.evaluadoLider === 0) {\n                QuestionsResource.query({leader: 0}, (result) => {\n                    vm.questionss = result;\n                });\n            } else {\n                QuestionsResource.query((result) => {\n                    vm.questionss = result;\n                });\n            }\n        };\n        CompetencesResource.query((result) => {\n            let aux = [];\n            let j = 0;\n            if (vm.evaluadoLider === 0) {\n                for (let aa in result) {\n                    if (result[aa].competenceCode != 'mando') {\n                        aux[j] = result[aa];\n                        j++;\n                    }\n                }\n                vm.competences = aux;\n            } else {\n                vm.competences = result;\n            }\n        });\n        loadPillarsAndStates();\n        vm.loadAll();\n    };\n    \n    /* Loads the pillars and states */\n    var loadPillarsAndStates = () => {\n        StatesResource.query((result) => {\n            vm.statess = result;\n        });\n        PillarsResource.query((result) => {\n            vm.pillars = result;\n        });\n    };\n\n\t/** Función para enviar la evaluación. */\n\tvm.submitForm = function (valido, datos, observaciones) {\n\t\tif (!vm.account.isLeader && vm.roleRRHH && !vm.roleADMIN) {\n\t\t\t// Dialogo de error al guardar un alta nueva siendo RRHH y no siendo leader\n\t\t\tvm.msgModal = 'errorRRHHAlta';\n            $('#myModalGuardado12345').modal('show');\n\t\t}\n\t\t// intenta autoevaluarse alguien no evaluable\n\t\telse if (Mentoring.isUndefinedOrNull(vm.evaluable.info) && !vm.account.isEvaluable) {\n\t\t\tvm.msgModal = 'errorNoEvaluable';\n            $('#myModalGuardado12345').modal('show');\n\t\t}\n\t\t// empleado se intenta autoevaluar cuando no es periodo de autoevaluacion\n\t\telse if (Mentoring.isUndefinedOrNull(vm.evaluable.info) && !vm.isEvaluationDate) {\n\t\t\tvm.msgModal = 'errorNoAutoEvaluable';\n            $('#myModalGuardado12345').modal('show');\n            \n\t\t} else if (valido) {\n\t\t\tif (vm.validarNoSeObserva(datos)) {\n\t\t\t\tvm.msgModal = 'correcto';\n\t\t\t\tlet evaluationToSave = null;\n\t\t\t\tlet evaluationType = null;\n\t\t\t\tlet employee = null;\n\t\t\t\t\n                if ((Mentoring.isUndefinedOrNull(vm.evaluable.info) || vm.evaluable.info.id === vm.employeeId) && vm.isEvaluationDate) {\n\t\t\t\t\temployee = vm.employeeId;\n\t\t\t\t\tevaluationType = 'auto';\n\t\t\t\t\tevaluationToSave = AnswersEval.agrupar2(datos, employee, employee, observaciones, evaluationType, vm.isFinalEvaluationDate, idToModify);\n\t\t\t\t} else {\n\t\t\t\t\tif (!(vm.roleDIRECTOR || vm.roleDIRECTORG || vm.roleADMIN)) {\n\t\t\t\t\t\temployee = vm.evaluable.info.employeeId;\n\t\t\t\t\t} else {\n\t\t\t\t\t\temployee = vm.evaluable.info.id;\n\t\t\t\t\t}\n\t\t\t\t\tvar evaluator = vm.employeeId;\n\t\t\t\t\tevaluationType = vm.isFinalEvaluationDate ? 'final' : 'eval';\n\t\t\t\t\tevaluationToSave = AnswersEval.agrupar2(datos, evaluator, employee, observaciones, evaluationType, vm.isFinalEvaluationDate, idToModify);\n\t\t\t\t}\n\t\t\t\tvar numDes = 1;\n\t\t\t\tvar numMej = 4;\n                \n\t\t\t\t//despues de guardar la evaluacion y recuperar el id , se guardan y se relacionan sus respuestas\n\t\t\t\tAnswersEval.guardar2(evaluationToSave).then((obj) => {\n\t\t\t\t\tlet currentEvalId = obj.data.id;\n\t\t\t\t\tlet respuestaJSON = AnswersEval.agrupar(datos, currentEvalId, vm.isFinalEvaluationDate);\n\t\t\t\t\tAnswersEval.guardar(respuestaJSON);\n\n\t\t\t\t\tlet respuestaJSON3 = AnswersEval.agrupar3(currentEvalId, numDes, vm.destacados, vm.isFinalEvaluationDate);\n\t\t\t\t\tAnswersEval.guardar3(respuestaJSON3);\n\t\t\t\t\t\n                    let respuestaJSON4 = AnswersEval.agrupar3(currentEvalId, numMej, vm.mejorar, vm.isFinalEvaluationDate);\n\t\t\t\t\tAnswersEval.guardar3(respuestaJSON4);\n                    \n                    $('#myModalGuardado12345').modal('show');\n\t\t\t\t}, (reason) => {\n\t\t\t\t\tvm.msgModal = 'guardarFalla';\n                    $('#myModalGuardado12345').modal('show');\n\t\t\t\t\tPrintService.print(reason.stack);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tvm.msgModal = 'noSeObserva';\n                $('#myModalGuardado12345').modal('show');\n\t\t\t}\n\t\t}\n\n\t};\n\n\t/**\n\t* Método que comprueba si sólo existe una respuesta \"No se Observa\" por pilar.\n\t* @param datos\n\t* \t\t\tDatos que ha contestado el usuario.\n\t* @return boolean\n\t* \t\t\tBooleano que indica si e\n\t*/\n\tvm.validarNoSeObserva = function (datos) {\n\t\tvar pillars = '';\n\t\tvar pillar;\n\t\tfor (var i in datos) {\n\t\t\tif (datos[i] === 6) {\n\t\t\t\tpillar = vm.getPillar('preg' + i);\n\t\t\t\t// Comprobamos si existe el pillar\n\t\t\t\tif (pillar !== 0) {\n\t\t\t\t\tif (pillars.indexOf(pillar) < 0) {\n\t\t\t\t\t\tpillars += pillar;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t};\n\n\t/**\n\t* Método que recupera del listado de competencias el código del pilar al que pertenece a partir del código de la competencia.\n\t* \n\t* @param questionId\n\t* \t\t\tIdentificador de la pregunta.\n\t* @return pillarId \n\t* \t\t\tindentificador del pilar al que pertenece la competencia\n\t*/\n\tvm.getPillar = function (questionId) {\n\t\tvar questions = vm.questionss;\n\t\tif (!Mentoring.isUndefinedOrNull(questions)) {\n\t\t\tfor (var i = 0, len=questions.length; i < len; i++) {\n\t\t\t\tif (questions[i].questionsCode === questionId) {\n\t\t\t\t\treturn questions[i].pillarId;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t};\n\n\n\tvm.add = function () {\n\t\tvm.listSelect = [];\n\t\tfor(var i=0; i<3;i++) {\n\t\t\tif (!Mentoring.isUndefinedOrNull(vm.destacados[i])) {\n\t\t\t\tvm.listSelect.push(vm.destacados[i]);\n\t\t\t}\n\t\t\tif (!Mentoring.isUndefinedOrNull(vm.mejorar[i])) {\n\t\t\t\tvm.listSelect.push(vm.mejorar[i]);\n\t\t\t}\n\t\t}\n\t};\n\t\n\tfunction getAnswersCodigo(codigoResp, push) {\n\t\tAnswersResource.query({id: codigoResp}, answersResourceCb);\n        \n\t\tAnswersSelect.query({id: codigoResp}, (result) => {\n\t\t\tfor(var i=0,len=result.length;i<len;i++) {\n\t\t\t\tif(i<3) {\n\t\t\t\t\tvm.destacados[i] = result[i].questionCode;\n\t\t\t\t} else {\n\t\t\t\t\tvm.mejorar[i] = result[i].questionCode;\n\t\t\t\t}\n\t\t\t\tif(push) {\n\t\t\t\t\tvm.listSelect.push(result[i].questionCode);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n    \n    var answersResourceCb = (result) => {\n        vm.respuesta = [];\n        for (var i in result) {\n            let item = result[i];\n            vm.respuesta[item.questionId] = item.statesId;\n            vm.selected[item.questionId] = item.statesId - 1;\n        }\n    }\n}\nangular.module('mentoringApp').controller('EvaluationController', EvaluationController);"]}