{"version":3,"sources":["../../../app/scripts/increments/increments.controller.js"],"names":[],"mappings":"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","file":"increments.controller.js","sourcesContent":["/* jshint -W097 */\n/* Controller for Increments Table functionality */\n'use strict';\n/*@ngInject*/\nfunction IncrementsController($rootScope, PositionIncreases, EvaluationMarkService, WageBandService, WageBandPositionService, \n        DirectionsService, $window) {\n\tvar vm = this;\n    /* Controller variables */\n    vm.direction = null;\n    vm.year = null;\n    vm.showTables = false;\n    vm.saveChanges = false;\n    vm.generalIncrease = 0.0;\n    \n\t$rootScope.activeOption = 'increments';\n    var defaults = {};\n    \n    /* Obtains the years */\n    PositionIncreases.getYears({}, (result) => {\n      vm.years = result;  \n    });\n    \n   /* Obtains the directions */\n    DirectionsService.query({}, (result) => {\n       vm.directions = result;\n    });\n    \n   /* Obtains from DB the IDs for marks, wage bands and wage band positions for the default object */\n    EvaluationMarkService.query({}, (result) => {\n        defaults.evaluationMarks = result;\n    });\n    WageBandService.query({}, (result) => {\n        defaults.wageBands = result;\n    })\n    WageBandPositionService.query({}, (result) => {\n       defaults.wageBandPositions = result; \n    });\n    \n    \n    /* Search for the positions */\n    vm.searchPositions = () => {\n        /* If both direction and year are selected, do it */\n        if(vm.direction!== null && vm.year !== null) {\n            /* Reset view flags to default */\n            vm.showTables = false;\n            vm.saveChanges = false;\n            vm.generalIncrease = 0.0;\n            \n            /* Reset vm.positions to default */\n            vm.positions = getDefaultPositions();\n            /* At first, we can save changes always */\n            vm.saveChanges = true;\n\n            PositionIncreases.query({year: vm.year, direction: vm.direction.id}, (result) => {\n                /* If there is no result for the given year, we search the year before.\n                Only if year is current year, so this way we can add new year positions starting from the last year positions. */\n                if (result.noPositionIncreases && vm.year === Mentoring.getCurrentYear()) {\n                    /* Request to year before */\n                    PositionIncreases.query({year: vm.year - 1, direction: vm.direction.id}, (result) => {\n                        handleSearchPositions(result, true);\n                    });\n                } else {\n                    handleSearchPositions(result, false);\n                }\n                vm.saveChanges = result.canSave;\n            });\n        /* Othewise, show a warning modal */\n        } else {\n            vm.Modal = {\n                msg: 'increments.increments.modal.warning.select',\n                title: 'increments.increments.modal.warning.title',\n                button: 'increments.increments.modal.ok',\n                action: () => {\n                    $('#myModal').modal('hide');\n                }\n            };\n            /* Now show the modal */\n            $('#myModal').modal('show');\n        }\n    };\n    \n    /* Send a save request to server */\n    vm.savePositions = () => {\n        /* Creates object to send */\n        var buss = vm.positions.business;\n        var staff = vm.positions.staff;\n        var object = {\n            v1: [], v2: [], v3: [], v4: []\n        }\n        for(var V in buss) {\n            var vName = V.toLowerCase();\n            for(var p in buss[V]) {\n                buss[V][p].map( (pos) => {\n                    object[vName].push(pos);\n                });\n            }\n        };\n        for(var V in staff) {\n            var vName = V.toLowerCase();\n            for(var p in buss[V]) {\n                staff[V][p].map( (pos) => {\n                    object[vName].push(pos);\n                });\n            }\n        };\n        object.generalIncrease = vm.generalIncrease;\n      \n        /* Send request */\n        PositionIncreases.savePositions({direction: vm.direction.id}, object, \n        /* If successful request... */\n        (result) => {\n            /* Creates a the object which contains the modal info to show */\n            vm.Modal = {\n                msg: 'increments.increments.modal.success',\n                title: 'increments.increments.modal.success.title',\n                button: 'increments.increments.modal.ok',\n                action: () => {\n                    $('#myModal').modal('hide');\n                    $window.location.reload();\n                }\n            };\n            /* Now show the modal */\n            $('#myModal').modal('show');\n        /* If error... */\n        }, (error) => {\n            vm.Modal = {\n                msg: 'increments.increments.modal.error',\n                title: 'increments.increments.modal.error.title',\n                button: 'increments.increments.modal.ok',\n                action: () => {\n                    $('#myModal').modal('hide');\n                }\n            };\n            $('#myModal').modal('show');\n        });\n    };\n    \n    /* Handles the positionIncreases response object to render the tables */\n    var handleSearchPositions = (result, removeId) => {\n        /* If there arent result, leave vm.positions as default */\n        if(!result.noPositionIncreases) {\n            /* First, reset the item's P arrays. This its easier to add the obtained values from server. */\n            vm.positions = getEmptyPositions();\n            \n            /* Sets the general increase */\n            vm.generalIncrease = result.generalIncrease;\n            \n            /* Iterate over the result properties looking for the arrays which contains the P values. */\n            for(var item in result) {\n                var V = result[item];\n                /* If the item is array, iterate it. */\n                if(Array.isArray(V)) {\n                    V.map((i) => {\n                        /* Check isBusiness flag to know is whether is business position or not. */\n                        var dest = vm.positions.staff[item];\n                        if(i.isBusiness) {\n                            dest = vm.positions.business[item];\n                        }\n                        /* Push the position to destination object */\n                        if (removeId) {\n                            i.id = null;\n                        }\n                        dest[i.name].push(i);\n                    });\n                }\n            }\n        }\n        vm.showTables = true;\n    }\n    \n    /* Returns a Postions object with empty P arrays. */\n    var getEmptyPositions = () => {\n        return {\n            business: {\n                v1: {P1:[], P2:[], P3:[], P4:[]},\n                v2: {P1:[], P2:[], P3:[], P4:[]},\n                v3: {P1:[], P2:[], P3:[], P4:[]},\n                v4: {P1:[], P2:[], P3:[], P4:[]}\n            },\n            staff: {\n                v1: {P1:[], P2:[], P3:[], P4:[]},\n                v2: {P1:[], P2:[], P3:[], P4:[]},\n                v3: {P1:[], P2:[], P3:[], P4:[]},\n                v4: {P1:[], P2:[], P3:[], P4:[]}\n            }\n        }\n    }\n    \n    /* Returns a default object representing an empty position increases */\n    var getDefaultPositions = () => {\n        var obj = {\n            business: {},\n            staff: {}\n        }\n        /* Obtains the code for each evaluation mark */\n        var fId = defaults.evaluationMarks.filter( (e) => { return e.code === 'F';}).map((m) => { return m.id;});\n        var dId = defaults.evaluationMarks.filter( (e) => { return e.code === 'B';}).map((m) => { return m.id;});\n        var cId = defaults.evaluationMarks.filter( (e) => { return e.code === 'A';}).map((m) => { return m.id;});\n        var bId = defaults.evaluationMarks.filter( (e) => { return e.code === 'A+';}).map((m) => { return m.id;});\n        var aId = defaults.evaluationMarks.filter( (e) => { return e.code === 'A++';}).map((m) => { return m.id;});\n        \n        for(var i=1; i<5;i++) {\n            var v = 'V' + i;\n            var vName = 'V' + i;\n            obj.business[v] = {};\n            obj.staff[v] = {};\n            /* Obtains the list of wage band ids which corresponds */\n            var wageBandId = {};\n            defaults.wageBands.filter( (w) => {\n                return w.name === vName;\n            }).map((p) => {\n                if(p.business) {\n                    wageBandId.business = p.id;\n                } else {\n                    wageBandId.staff = p.id;\n                }\n            });\n            \n            /* Creates the object */\n            for(var z=1; z<5; z++) {\n                var p = 'P' + z;\n                var pId = defaults.wageBandPositions.filter((pos) => {\n                    return pos.name === p;\n                });\n                obj.business[v][p] = [{positionId:pId[0].id, bandName:vName, bandId: wageBandId.business, isBusiness:true, markId: fId[0], markCode:'F',value:0.0},\n                                  {positionId:pId[0].id, bandName:vName, bandId: wageBandId.business, isBusiness:true, markId: dId[0], markCode:'B',value:0.0},\n                                  {positionId:pId[0].id, bandName:vName, bandId: wageBandId.business, isBusiness:true, markId: cId[0], markCode:'A',value:0.0},\n                                  {positionId:pId[0].id, bandName:vName, bandId: wageBandId.business, isBusiness:true, markId: bId[0], markCode:'A+',value:0.0},\n                                  {positionId:pId[0].id, bandName:vName, bandId: wageBandId.business, isBusiness:true, markId: aId[0], markCode:'A++',value:0.0}];\n                obj.staff[v][p] = [{positionId:pId[0].id, bandName:vName, bandId: wageBandId.staff, isBusiness:false, markId: fId[0], markCode:'F',value:0.0},\n                                  {positionId:pId[0].id, bandName:vName, bandId: wageBandId.staff, isBusiness:false, markId: dId[0], markCode:'B',value:0.0},\n                                  {positionId:pId[0].id, bandName:vName, bandId: wageBandId.staff, isBusiness:false, markId: cId[0], markCode:'A',value:0.0},\n                                  {positionId:pId[0].id, bandName:vName, bandId: wageBandId.staff, isBusiness:false, markId: bId[0], markCode:'A+',value:0.0},\n                                  {positionId:pId[0].id, bandName:vName, bandId: wageBandId.staff, isBusiness:false, markId: aId[0], markCode:'A++',value:0.0}];\n            }\n        }\n        return obj;\n    }\n};\nangular.module('mentoringApp').controller('IncrementsController', IncrementsController);"]}