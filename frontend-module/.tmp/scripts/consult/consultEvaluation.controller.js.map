{"version":3,"sources":["../../../app/scripts/consult/consultEvaluation.controller.js"],"names":[],"mappings":"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","file":"consultEvaluation.controller.js","sourcesContent":["/* jshint -W097 */\r\n/* globals angular, $, Mentoring*/\r\n'use strict';\r\n/*@ngInject*/\r\nfunction ConsultEvaluationController($scope, $timeout, $sce, $state, $stateParams, $window, $previousState, Principal, $translate, QuestionsResource,  \r\n\tStatesResource, AnswersResource, CompetencesResource, PillarsResource, SharingEvaluationService, EvaluationId, \r\n\tEmployeeIsLeaderResource, AnswersSelect, AnswersEval, isEvaluationDate, isFinalEvaluationDate, CurrentAllocation,\r\n\tCalculateEvaluationResult) {\r\n \r\n\t$previousState.memo('consult');\r\n\tvar vm = this;\r\n\t$scope.chart;\r\n\t\r\n    // Check if we come from consult state, otherwise redirect to it.\r\n    let prevState = $previousState.get('consult');\r\n    if(prevState.state === null) {\r\n        $state.go('consult');\r\n    }\r\n\tvm.evaluation = prevState.params.evaluation;\r\n    vm.showInput = prevState.params.showInput;\r\n\t\r\n\tif ( $state.current.name != 'login' ) {\r\n\t\tPrincipal.identity().then(function(account) {\r\n\t\t\tvm.account = account;\r\n\r\n\t\t\tvm.showPrint = false;\r\n\t\t\tif (!Mentoring.isUndefinedOrNull(account) && !Mentoring.isUndefinedOrNull(account.roles) && !Mentoring.isUndefinedOrNull(account.isLeader)) {\r\n\t\t\t\tvm.isLeader = account.isLeader;\r\n\t\t\t\tvm.employeeId = account.employeeId;\r\n\t\t\t\tvm.user = {\r\n                    firstName: account.firstName,\r\n                    lastName: account.lastName\r\n                }\r\n\t\t\t\tvm.finalEvaluation=false;\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\tprepareChart();\r\n\t\t\t\tvm.questions = [];\r\n\t\t\t\tvm.states = [];\r\n\t\t\t\tvm.empleado = [];\r\n\t\t\t\tvm.competence = [];\r\n\t\t\t\tvm.pillar = [];\r\n\t\t\t\tvm.correcto = false;\r\n\t\t\t\tvm.evaluable = [];\r\n\t\t\t\tvm.consult = false;\r\n\t\t\t\tvm.esModificable=false;\r\n\t\t\t\tvm.evaluable.info=[];\r\n\t\t\t\tvm.destacados=[];\r\n\t\t\t\tvm.mejorar=[];\r\n\t\t\t\tvm.selected = [];\r\n\t\t\t\tvm.respuesta = [];\r\n\r\n\t\t\t\tisEvaluationDate.get(function(isDate) {\r\n\t\t\t\t\tvm.isEvaluationDate = isDate.value;\r\n\t\t\t\t});\r\n\t\t\t\tisFinalEvaluationDate.get(function(isDate) {\r\n\t\t\t\t\tvm.isFinalEvaluationDate = isDate.value;\r\n\t\t\t\t});\r\n\t\t\r\n\t\t\t\tvar id = SharingEvaluationService.getId();\r\n\t\t\t\tvar esModificable = SharingEvaluationService.getModification();\r\n\r\n\t\t\t\t// Check if the user can modify the evaluation type. This will be possible if the evaluation can be modified\r\n\t\t\t\t// and the user has one of this roles : ADMIN, DIRECTOR_GENERAL or HR.\r\n\t\t\t\tvm.userCanModifyType = false;\r\n\t\t\t\tif (esModificable && account.roles.length > 1) {\r\n\t\t\t\t\tvar userRoles = account.roles;\r\n\t\t\t\t\tif (userRoles.indexOf('ROLE_ADMIN') > -1 || userRoles.indexOf('ROLE_RRHH') > -1 \r\n\t\t\t\t\t\t|| userRoles.indexOf('ROLE_DIRECTORG') > -1 ) {\r\n\t\t\t\t\t\t\tvm.userCanModifyType = true;\r\n\t\t\t\t\t\t\t// Creates array of options for combo\r\n\t\t\t\t\t\t\tvm.evaluationTypes = [\r\n\t\t\t\t\t\t\t\t{id: 'auto', value: $translate.instant('consult.evaluation.auto')},\r\n\t\t\t\t\t\t\t\t{id: 'eval', value: $translate.instant('consult.evaluation.eval')},\r\n\t\t\t\t\t\t\t\t{id: 'final', value: $translate.instant('consult.evaluation.final')}\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tvm.evaluadoo = SharingEvaluationService.getEvaluado();\r\n\t\t\t\tvm.esModificable = esModificable;\r\n\t\t\t\t\r\n\t\t\t\tvar year_evaluation;\r\n\t\t\t\tif (!Mentoring.isUndefinedOrNull(vm.evaluadoo)){\r\n\t\t\t\t\tvm.date =  vm.evaluadoo.creationDate;\r\n\t\t\t\t\tyear_evaluation = new Date(vm.evaluadoo.creationDate).getFullYear();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvm.getQuestionCode= function(questionCode) {\r\n\t\t\t\t\tvm.codePregunta = questionCode; \r\n\t\t\t\t\tvm.definicionInfo = $sce.trustAsHtml($translate.instant('evaluation.info.'+questionCode+'.comportamientoInfo'));\r\n\t\t\t\t};\r\n\t\t\t\r\n\t\t\t\tvm.evaluationId = [];\r\n\r\n\t\t\t\tEvaluationId.get({id: id}, function(result){\r\n\t\t\t\t\tif (!Mentoring.isUndefinedOrNull(result)){\r\n\t\t\t\t\t\tvm.evaluationId = result;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Check if we need to show the print button. The first to check is if it's a final evaluation\r\n\t\t\t\t\t\tif(result.evaluationType === 'final') {\r\n\t\t\t\t\t\t\t// If the user has only one role and it's ROLE_USER, check whether if the employee\r\n\t\t\t\t\t\t\t// is checking his own evaluation, or if it's the actual employee's evaluator\r\n\t\t\t\t\t\t\tif (account.roles.length == 1 && account.roles.indexOf('ROLE_USER') == 0) {\r\n\t\t\t\t\t\t\t\tif (account.employeeId == result.employeeId) {\r\n\t\t\t\t\t\t\t\t\tvm.showPrint = true;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t// Obtain actual employee's evaluator\r\n\t\t\t\t\t\t\t\t\tCurrentAllocation.get({employeeId: result.employeeId}, (res) => {\r\n\t\t\t\t\t\t\t\t\t\tif (res.leaderId != undefined && account.employeeId === res.leaderId) {\r\n\t\t\t\t\t\t\t\t\t\t\tvm.showPrint = true;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tvm.showPrint = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar finalEvaluationNum = vm.evaluationId.evaluationType;\r\n\t\t\t\t\t\tif (finalEvaluationNum=='final'){\r\n\t\t\t\t\t\t\tvm.finalEvaluation = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tEmployeeIsLeaderResource.get({employeeId: vm.evaluationId.employeeId} , function(result2){\r\n\t\t\t\t\t\t\tvm.isLeader=parseInt(result2[0]);\r\n\t\t\t\t\t\t\tif (!Mentoring.isUndefinedOrNull(result2[0])){\t\r\n\t\t\t\t\t\t\t\t\tvm.loadAll = function() {\r\n\t\t\t\t\t\t\t\t\t\tStatesResource.query(function(result) {\r\n\t\t\t\t\t\t\t\t\t\t\tvm.statess = result;\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tCompetencesResource.query(function(result) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar aux = [];\r\n\t\t\t\t\t\t\t\t\t\t\tvar j=0;\r\n\t\t\t\t\t\t\t\t\t\t\tif (vm.isLeader === 0){\r\n\t\t\t\t\t\t\t\t\t\t\t\tfor (var i in result){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (result[i].competenceCode != 'mando'){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taux[j]=result[i];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tj++;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tvm.competences = aux;\r\n\t\t\t\t\t\t\t\t\t\t\t} else{\r\n\t\t\t\t\t\t\t\t\t\t\t\tvm.competences = result;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tPillarsResource.query(function(result) {\r\n\t\t\t\t\t\t\t\t\t\t\tvm.pillars = result;\r\n\t\t\t\t\t\t\t\t\t\t\tif (vm.isLeader === 0){\r\n\t\t\t\t\t\t\t\t\t\t\t\tQuestionsResource.query({id: 0} ,function(result) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tvm.questionss = result;  \r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t} else{\r\n\t\t\t\t\t\t\t\t\t\t\t\tQuestionsResource.query(function(result) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tvm.questionss = result;  \r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tvm.select= function(index, idPregunta) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tvm.selected[idPregunta] = index; \r\n\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tif (vm.evaluationId.employeeId == vm.evaluationId.leaderId){\r\n\t\t\t\t\t\t\t\t\t\t\t\tvm.employeeId=vm.evaluationId.employeeId;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\telse{\r\n\t\t\t\t\t\t\t\t\t\t\t\tvm.evaluable.info.employeeId=vm.evaluationId.employeeId;\r\n\t\t\t\t\t\t\t\t\t\t\t\tvm.employeeId=vm.evaluationId.leaderId;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tvm.observaciones = vm.evaluationId.observaciones;\r\n                                            vm.observacionesEvaluador = vm.evaluationId.observacionesEvaluador;\r\n\t\r\n\t\t\t\t\t\t\t\t\t\t\tAnswersResource.query({id:id}, function(result) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar seleccionados = [];\r\n\t\t\t\t\t\t\t\t\t\t\t\tfor (var i in result){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tseleccionados[result[i].questionId]=result[i].statesId;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvm.selected[result[i].questionId] = result[i].statesId -1; \r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tvm.respuesta = seleccionados;\r\n\t\t\t\t\t\t\t\t\t\t\t\tAnswersSelect.query({id:id}, function(result22) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (result22.length>0){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (result22.length>0){\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.destacados[0] = result22[0].questionCode;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.listSelect.push(vm.destacados[0]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.destacados[1] = result22[1].questionCode;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.listSelect.push(vm.destacados[1]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.destacados[2] = result22[2].questionCode;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.listSelect.push(vm.destacados[2]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.mejorar[0] = result22[3].questionCode;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.listSelect.push(vm.mejorar[0]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.mejorar[1] = result22[4].questionCode;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.listSelect.push(vm.mejorar[1]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.mejorar[2] = result22[5].questionCode;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvm.listSelect.push(vm.mejorar[2]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\t\t   \r\n\t\t\t\t\t\t\t\t\t\t\t});\t\r\n\t\t\t\t\t\t\t\t\t\t\tStatesResource.query(function(result) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tvm.statess = result;\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\tvm.loadAll();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});         \r\n\t\t\t\t\r\n\t\t\t\tvar getEvaluationType = function() {\r\n\t\t\t\t\tif (vm.userCanModifyType) {\r\n\t\t\t\t\t\treturn \r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tvm.submitForm = function(valido, datos, observaciones, observacionesEvaluador) {\r\n\t\t\t\t\tif (valido) {\r\n\t\t\t\t\t\tif (validarNoSeObserva(datos)) {\r\n\t\t\t\t\t\t\tvm.correcto = true;\r\n\t\t\t\t\t\t\tvar employee, evaluationType, evaluationToSave, evaluator;\r\n\t\t\t\t\t\t\tif (Mentoring.isUndefinedOrNull(vm.evaluable.info.employeeId)){\r\n\t\t\t\t\t\t\t\temployee = vm.employeeId;\r\n\t\t\t\t\t\t\t\tevaluationType = 'auto';\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tevaluationToSave = AnswersEval.agrupar2(datos,employee,employee, observaciones, observacionesEvaluador,\r\n\t\t\t\t\t\t\t\t\tevaluationType, vm.isFinalEvaluationDate,id);\r\n\t\t\t\t\t\t\t} else{\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif(!(vm.roleDIRECTOR || vm.roleDIRECTORG || vm.roleADMIN )){\r\n\t\t\t\t\t\t\t\t\temployee = vm.evaluable.info.employeeId;\r\n\t\t\t\t\t\t\t\t} else{\r\n\t\t\t\t\t\t\t\t\temployee = vm.evaluable.info.id;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tevaluator = vm.employeeId;\r\n\t\t\t\t\t\t\t\tevaluationType = vm.isFinalEvaluationDate ? 'final' : 'eval';\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tevaluationToSave = AnswersEval.agrupar2(datos, evaluator, employee, observaciones, observacionesEvaluador,\r\n\t\t\t\t\t\t\t\t\tevaluationType, vm.isFinalEvaluationDate,id);\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// If the user can modify the evaluation type, override it\r\n\t\t\t\t\t\t\tif (vm.userCanModifyType) {\r\n\t\t\t\t\t\t\t\tevaluationToSave.evaluationType = vm.evaluation.evaluationType;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvar numDes = 1;\r\n\t\t\t\t\t\t\tvar numMej = 4;\r\n\t\t\t\t\t\t\tlet answer = AnswersEval.agrupar(datos, 0, vm.isFinalEvaluationDate);\r\n\t\t\t\t\t\t\tlet answerOutstanding = AnswersEval.agrupar3(0, numDes, vm.destacados, vm.isFinalEvaluationDate);\r\n\t\t\t\t\t\t\tlet answerImprovable = AnswersEval.agrupar3(0, numMej, vm.mejorar, vm.isFinalEvaluationDate);\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\tlet obj = {\r\n\t\t\t\t\t\t\t\tevaluation: evaluationToSave,\r\n\t\t\t\t\t\t\t\tanswers: answer,\r\n\t\t\t\t\t\t\t\toutstanding: answerOutstanding,\r\n\t\t\t\t\t\t\t\timprovable: answerImprovable\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\tvm.disableButton = true;\r\n\t\t\t\t\t\t\t//despues de guardar la evaluacion y recuperar el id , se guardan y se relacionan sus respuestas\t     \t\t\r\n\t\t\t\t\t\t\tAnswersEval.guardar2(obj).then((obj) => {\r\n\t\t\t\t\t\t\t\tlet msgModal = '';\r\n\t\t\t\t\t\t\t\tif(obj.data.msg == 'save.evaluation.no.mark') {\r\n\t\t\t\t\t\t\t\t\tmsgModal = 'guardarCorrectoNoNota';\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tmsgModal = 'guardarCorrecto';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvm.Modal = {\r\n\t\t\t\t\t\t\t\t\tmsg: msgModal,\r\n\t\t\t\t\t\t\t\t\ttitle: 'consult.modal.ok.title',\r\n\t\t\t\t\t\t\t\t\tbutton: 'consult.modal.ok',\r\n\t\t\t\t\t\t\t\t\taction: () => {\r\n\t\t\t\t\t\t\t\t\t\t$('#myModal').on('hidden.bs.modal', () => {\r\n\t\t\t\t\t\t\t\t\t\t\t$('#myModal').unbind('hidden.bs.modal');\r\n\t\t\t\t\t\t\t\t\t\t\t$stateParams.empleado = vm.employeeId;\r\n\t\t\t\t\t\t\t\t\t\t\t$state.go('consult');\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t$('#myModal').modal('hide');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t$('#myModal').modal('show');\r\n\t\t\t\t\t\t\t}, (err) => {\r\n\t\t\t\t\t\t\t\tvar msg = err.data.msg || 'guardarFalla';\r\n\t\t\t\t\t\t\t\tvm.Modal = {\r\n\t\t\t\t\t\t\t\t\tmsg: msg,\r\n\t\t\t\t\t\t\t\t\ttitle: 'consult.modal.error.title',\r\n\t\t\t\t\t\t\t\t\tbutton: 'consult.modal.ok',\r\n\t\t\t\t\t\t\t\t\taction: () => {\r\n\t\t\t\t\t\t\t\t\t\t$('#myModal').modal('hide');\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t$('#myModal').modal('show');\r\n\t\t\t\t\t\t\t\tvm.disableButton = false;\r\n\t\t\t\t\t\t\t});\t      \t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvm.Modal = {\r\n\t\t\t\t\t\t\tmsg: 'guardarNoSeObserva',\r\n\t\t\t\t\t\t\ttitle: 'consult.modal.error.title',\r\n\t\t\t\t\t\t\tbutton: 'consult.modal.ok',\r\n\t\t\t\t\t\t\taction: () => {\r\n\t\t\t\t\t\t\t\t$('#myModal').modal('hide');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\t$('#myModal').modal('show');\r\n\t\t\t\t\t\t\tvm.disableButton = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tvm.listSelect=[];\r\n\t\t\t\tvm.add = function(){\r\n\t\t\t\t\tvm.listSelect=[];\r\n\t\t\t\t\tfor(var i=0;i<3;i++) {\r\n\t\t\t\t\t\tif(!Mentoring.isUndefinedOrNull(vm.destacados[i])) {\r\n\t\t\t\t\t\t\tvm.listSelect.push(vm.destacados[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(!Mentoring.isUndefinedOrNull(vm.mejorar[i])) {\r\n\t\t\t\t\t\t\tvm.listSelect.push(vm.mejorar[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tif ($state.current.name != 'login') {\r\n\t\t\t\tvm.isAuthenticated = Principal.isAuthenticated();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n    \r\n\tvar prepareChart = () => {\r\n\t\t$scope.options =  {\r\n\t\t\tresponsive: true,\r\n\t\t\tscaleShowLine : true,\r\n    \t\tscaleOverride: true,\r\n\t\t\tscaleSteps: 5,\r\n\t\t\tscaleStepWidth: 20,\r\n\t\t\tscaleStartValue: 0,\r\n\t\t\tangleShowLineOut : true,\r\n\t\t\tscaleBeginAtZero : true,\r\n\t\t\tangleLineColor : 'rgba(0,0,0,.1)',\r\n\t\t\tangleLineWidth : 1,\r\n\t\t\tpointLabelFontFamily : '\"Arial\"',\r\n\t\t\tpointLabelFontStyle : 'normal',\r\n\t\t\tpointLabelFontSize : 10,\r\n\t\t\tpointLabelFontColor : '#666',\r\n\t\t\tpointDot : true,\r\n\t\t\tpointDotRadius : 3,\r\n\t\t\tpointDotStrokeWidth : 1,\r\n\t\t\tpointHitDetectionRadius : 20,\r\n\t\t\tdatasetStroke : true,\r\n\t\t\tdatasetStrokeWidth : 2,\r\n\t\t\tdatasetFill : true,\r\n\t\t\tlegend: {\r\n\t\t\t\tdisplay: false\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// If there is evaluation result coming from the server, typical case\r\n\t\tif(vm.evaluation.evaluationResult) {\r\n\t\t\thandleEvaluationResult(vm.evaluation.evaluationResult);\r\n\t\t} else {\r\n\t\t\t// If not, case when the evaluation results weren't saved into db\r\n\t\t\tCalculateEvaluationResult.get({\r\n\t\t\t\temployeeId: vm.evaluadoo.employeeId, \r\n\t\t\t\tevaluationId:vm.evaluadoo.id, \r\n\t\t\t\tyear: year_evaluation\r\n\t\t\t}, handleEvaluationResult);\r\n\t\t}\r\n\t}\r\n\r\n     var handleEvaluationResult = (result) => {\r\n        var labelsCompetences = null;\r\n        var dataCompetences = null;\r\n\r\n        if (result.resultCompetences.length == 3) {\r\n            labelsCompetences = ['Talent', 'Attitude', 'Business', 'Talent/Attitude', 'Business', 'VASS'];\r\n\t\t\tvar compByPillarScore_0 = result.resultCompetences[0].scoreByPillar;\r\n\t\t\tvar compByPillarScore_1 = result.resultCompetences[1].scoreByPillar;\r\n\t\t\tvar compByPillarScore_2 = result.resultCompetences[2].scoreByPillar;\r\n            dataCompetences = [compByPillarScore_0[1], compByPillarScore_0[2], compByPillarScore_0[3], \r\n\t\t\t\t\t\t\tcompByPillarScore_1[4], compByPillarScore_1[5], compByPillarScore_2[6]];\r\n        \r\n        } else if (result.resultCompetences.length == 2) {\r\n            labelsCompetences = ['Talent', 'Attitude', 'Business', 'VASS'];\r\n\t\t\tvar compByPillarScore_0 = result.resultCompetences[0].scoreByPillar;\r\n\t\t\tvar compByPillarScore_1 = result.resultCompetences[1].scoreByPillar;\r\n            dataCompetences = [compByPillarScore_0[1], compByPillarScore_0[2], compByPillarScore_0[3], compByPillarScore_1[6]];\r\n        }\r\n\r\n\t\t// Chart.js Data\r\n\t\t$scope.data = {\r\n\t\t\tupdate: false,\r\n\t\t\tlabels: labelsCompetences,\r\n\t\t\tdatasets: [{\r\n\t\t\t\tfillColor: 'rgba(151,187,205,0.2)',\r\n\t\t\t\tstrokeColor: 'rgba(151,187,205,1)',\r\n\t\t\t\tpointColor: 'rgba(151,187,205,1)',\r\n\t\t\t\tpointStrokeColor: '#fff',\r\n\t\t\t\tpointHighlightFill: '#fff',\r\n\t\t\t\tpointHighlightStroke: 'rgba(220,220,220,1)',\r\n\t\t\t\tdata: dataCompetences\r\n\t\t\t}]\r\n\t\t};\r\n\t\tvm.noteEvaluation = result.note;\r\n    }\r\n\t\r\n\tvar validarNoSeObserva = function (datos) {\r\n\t\tvar pillars = '';\r\n\t\tvar pillar;\r\n\t\tfor (var i in datos) {\r\n\t\t\tif (datos[i] === 6) {\r\n\t\t\t\tpillar = getPillar('preg' + i);\r\n\t\t\t\t// Comprobamos si existe el pillar\r\n\t\t\t\tif (pillar !== 0) {\r\n\t\t\t\t\tif (pillars.indexOf(pillar) < 0) {\r\n\t\t\t\t\t\tpillars += pillar;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n\t\r\n\tvar getPillar = function (questionId) {\r\n\t\tvar questions = vm.questionss;\r\n\t\tif (!Mentoring.isUndefinedOrNull(questions)) {\r\n\t\t\tfor (var i = 0, len=questions.length; i < len; i++) {\r\n\t\t\t\tif (questions[i].questionsCode === questionId) {\r\n\t\t\t\t\treturn questions[i].pillarId;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 0;\r\n\t};\r\n\r\n\tvm.printEvaluation = function() {\r\n\t\tvar loc = window.location;\r\n\t\tvar printUrl = loc.origin + loc.pathname;\r\n\t\tprintUrl = 'api/evaluation/evaluation.pdf?evaluationId=' + vm.evaluationId.id;\r\n\t\twindow.open(printUrl);\r\n\t}\r\n\r\n\r\n\t// Check if the chartdiv is on scroll, to fire resize event.\r\n\t// It's the only way to repaint the chart...\r\n\t$(window).on('scroll', (el, callback) => {\r\n\t\tif ($(window).scrollTop() + window.innerHeight >= ($('canvas').offset().top - $('canvas').innerHeight())) {\r\n\t\t\twindow.dispatchEvent(new Event('resize'));\r\n\t\t\t// Once the event has been fired, it's not necessary anymore\r\n\t\t\t$(window).unbind('scroll');\r\n\t\t}\r\n\t}); \r\n}\r\nangular.module('mentoringApp').controller('ConsultEvaluationController', ConsultEvaluationController);"]}